(()=>{var R={items:[],allowNew:!1,showAllSuggestions:!1,badgeStyle:"primary",allowClear:!1,clearEnd:!1,selected:[],regex:"",separator:[],max:0,clearLabel:"Clear",searchLabel:"Type a value",showDropIcon:!0,keepOpen:!1,allowSame:!1,baseClass:"",placeholder:"",addOnBlur:!1,showDisabled:!1,hideNativeValidation:!1,suggestionsThreshold:-1,maximumItems:0,autoselectFirst:!0,updateOnSelect:!1,highlightTyped:!1,highlightClass:"",fullWidth:!0,fixed:!1,fuzzy:!1,startsWith:!1,singleBadge:!1,activeClasses:["bg-primary","text-white"],labelField:"label",valueField:"value",searchFields:["label"],queryParam:"query",server:"",serverMethod:"GET",serverParams:{},serverDataKey:"data",fetchOptions:{},liveServer:!1,noCache:!0,allowHtml:!1,debounceTime:300,notFoundMessage:"",inputFilter:n=>n,sanitizer:n=>X(n),onRenderItem:(n,e,t)=>t.config("allowHtml")?e:t.config("sanitizer")(e),onSelectItem:(n,e)=>{},onClearItem:(n,e)=>{},onCreateItem:(n,e)=>{},onBlur:(n,e)=>{},onDataLoaded:(n,e)=>{},onFocus:(n,e)=>{},onCanAdd:(n,e,t)=>{},confirmClear:(n,e)=>Promise.resolve(),confirmAdd:(n,e)=>Promise.resolve(),onServerResponse:(n,e)=>n.json(),onServerError:(n,e,t)=>{n.name==="AbortError"||e.aborted||console.error(n)}},p="tags-",j="is-loading",q="is-active",_="is-invalid",B="is-max-reached",S="show",b="data-value",A="next",k="prev",T="form-control-focus",z="form-placeholder-shown",J="form-control-disabled",C=new WeakMap,G=0,y=window.bootstrap&&window.bootstrap.Tooltip;function ce(n,e=300){let t;return(...i)=>{clearTimeout(t),t=setTimeout(()=>{n.apply(this,i)},e)}}function K(n,e=document.body){let t=m("span");e.appendChild(t),t.style.fontSize="inherit",t.style.height="auto",t.style.width="auto",t.style.position="absolute",t.style.whiteSpace="no-wrap",t.innerHTML=X(`${n}`);let i=Math.ceil(t.clientWidth);return e.removeChild(t),i<=20&&e!==document.body?K(n,document.body):i}function he(n){if(!n.includes("#"))return!0;let e=+("0x"+n.slice(1).replace(n.length<5&&/./g,"$&$&")),t=e>>16,i=e>>8&255,s=e&255;return Math.sqrt(.299*(t*t)+.587*(i*i)+.114*(s*s))>127.5}function X(n){return n.replace(/[\x26\x0A\<>'"]/g,function(e){return"&#"+e.charCodeAt(0)+";"})}function de(n){return n.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function F(n){return n?de(n.toString()).toLowerCase():""}function fe(n,e){if(n.indexOf(e)>=0)return!0;let t=0;for(let i=0;i<e.length;i++){let s=e[i];if(s!==" "&&(t=n.indexOf(s,t)+1,t<=0))return!1}return!0}function L(n){n.style.display="none",w(n,{"aria-hidden":"true"})}function U(n){n.style.display="list-item",w(n,{"aria-hidden":"false"})}function w(n,e){for(let[t,i]of Object.entries(e))n.setAttribute(t,i)}function v(n,e){n.hasAttribute(e)&&n.removeAttribute(e)}function Y(n){return["true","false","1","0",!0,!1].includes(n)&&!!JSON.parse(n)}function m(n){return document.createElement(n)}function ue(n,e){let t=e[0],i=n;for(let s=1;s<e.length;s++)i=i.split(e[s]).join(t);return i.split(t)}function me(n,e="window"){return n.split(".").reduce((t,i)=>t[i],e)}var D=class n{constructor(e,t={}){if(!(e instanceof HTMLElement)){console.error("Invalid element",e);return}C.set(e,this),G++,this._selectElement=e,this._configure(t),this._isMouse=!1,this._keyboardNavigation=!1,this._searchFunc=ce(()=>{this._loadFromServer(!0)},this._config.debounceTime),this._fireEvents=!0,this._configureParent(),this._holderElement=m("div"),this._containerElement=m("div"),this._dropElement=m("ul"),this._searchInput=m("input"),this._holderElement.appendChild(this._containerElement),this._selectElement.parentElement.insertBefore(this._holderElement,this._selectElement),this._configureHolderElement(),this._configureContainerElement(),this._configureSelectElement(),this._configureSearchInput(),this._configureDropElement(),this.resetState(),this.handleEvent=i=>{this._handleEvent(i)},this._config.fixed&&(document.addEventListener("scroll",this,!0),window.addEventListener("resize",this)),Array.isArray(this._config.separator)&&(this._config.separator=this._config.separator.filter(i=>i)),this._config.labelField!=="label"&&this._config.searchFields.includes("label")&&this._config.searchFields.length===1&&(this._config.searchFields=[this._config.labelField]);for(let i of["focus","blur","input","keydown","paste"])this._searchInput.addEventListener(i,this);for(let i of["mousemove","mouseleave"])this._dropElement.addEventListener(i,this);this.loadData(!0)}static init(e="select[multiple]",t={},i=!1){let s=document.querySelectorAll(e);for(let o=0;o<s.length;o++){let l=n.getInstance(s[o]);l&&!i||(l&&l.dispose(),new n(s[o],t))}}static getInstance(e){if(C.has(e))return C.get(e)}dispose(){for(let e of["focus","blur","input","keydown","paste"])this._searchInput.removeEventListener(e,this);for(let e of["mousemove","mouseleave"])this._dropElement.removeEventListener(e,this);this._config.fixed&&(document.removeEventListener("scroll",this,!0),window.removeEventListener("resize",this)),this._selectElement.style.display="block",this._holderElement.parentElement.removeChild(this._holderElement),this.parentForm&&this.parentForm.removeEventListener("reset",this),C.delete(this._selectElement)}handleEvent(e){this._handleEvent(e)}_handleEvent(e){["scroll","resize"].includes(e.type)?(this._timer&&window.cancelAnimationFrame(this._timer),this._timer=window.requestAnimationFrame(()=>{this[`on${e.type}`](e)})):this[`on${e.type}`](e)}_configure(e={}){this._config=Object.assign({},R,{showDropIcon:!!this._findOption()});let t=this._selectElement.dataset.config?JSON.parse(this._selectElement.dataset.config):{},i={...e,...t,...this._selectElement.dataset};for(let[s,o]of Object.entries(R)){if(s==="config"||i[s]===void 0)continue;let l=i[s];switch(typeof o){case"number":this._config[s]=parseInt(l);break;case"boolean":this._config[s]=Y(l);break;case"string":this._config[s]=l.toString();break;case"object":this._config[s]=l,typeof l=="string"&&(["{","["].includes(l[0])?this._config[s]=JSON.parse(l):this._config[s]=l.split(l.includes("|")?"|":","));break;case"function":this._config[s]=typeof l=="string"?l.split(".").reduce((r,a)=>r[a],window):l,this._config[s]||console.error("Invalid function",l);break;default:this._config[s]=l;break}}this._config.placeholder||(this._config.placeholder=this._getPlaceholder()),this._config.suggestionsThreshold==-1&&(this._config.suggestionsThreshold=this._config.liveServer?1:0)}config(e=null){return e?this._config[e]:this._config}setConfig(e,t){this._config[e]=t}_configureParent(){for(this.overflowParent=null,this.parentForm=this._selectElement.parentElement;this.parentForm&&(this.parentForm.style.overflow==="hidden"&&(this.overflowParent=this.parentForm),this.parentForm=this.parentForm.parentElement,!(this.parentForm&&this.parentForm.nodeName=="FORM")););this.parentForm&&this.parentForm.addEventListener("reset",this)}_getPlaceholder(){if(this._selectElement.hasAttribute("placeholder"))return this._selectElement.getAttribute("placeholder");if(this._selectElement.dataset.placeholder)return this._selectElement.dataset.placeholder;let e=this._selectElement.querySelector("option");return!e||!this._config.autoselectFirst?"":(v(e,"selected"),e.selected=!1,e.value?"":e.textContent)}_configureSelectElement(){let e=this._selectElement;this._config.hideNativeValidation?(e.style.position="absolute",e.style.left="-9999px"):e.style.cssText="height:1px;width:1px;opacity:0;padding:0;margin:0;border:0;float:left;flex-basis:100%;min-height:unset;",e.tabIndex=-1,e.addEventListener("focus",t=>{this.onclick(t)}),e.addEventListener("invalid",t=>{this._holderElement.classList.add(_)})}_configureDropElement(){let e=this._dropElement;e.classList.add("dropdown-menu",`${p}menu`),e.id=`${p}menu-${G}`,e.setAttribute("role","menu");let t=e.style;t.padding="0",t.maxHeight="280px",this._config.fullWidth||(t.maxWidth="360px"),this._config.fixed&&(t.position="fixed"),t.overflowY="auto",t.overscrollBehavior="contain",t.textAlign="unset",e.addEventListener("mouseenter",i=>{this._keyboardNavigation=!1}),this._holderElement.appendChild(e),this._searchInput.setAttribute("aria-controls",e.id)}_configureHolderElement(){let e=this._holderElement;e.classList.add("form-control","dropdown"),["form-select-lg","form-select-sm","is-invalid","is-valid"].forEach(t=>{this._selectElement.classList.contains(t)&&e.classList.add(t)}),this._config.suggestionsThreshold==0&&this._config.showDropIcon&&e.classList.add("form-select"),this.overflowParent&&(e.style.position="inherit"),e.style.height="auto",e.addEventListener("click",this)}_configureContainerElement(){this._containerElement.addEventListener("click",t=>{this.isDisabled()||this._searchInput.style.visibility!=="hidden"&&this._searchInput.focus()});let e=this._containerElement.style;e.display="flex",e.alignItems="center",e.flexWrap="wrap"}_configureSearchInput(){let e=this._searchInput;e.type="text",e.autocomplete="off",e.spellcheck=!1,w(e,{"aria-autocomplete":"list","aria-haspopup":"menu","aria-expanded":"false","aria-label":this._config.searchLabel,role:"combobox"}),e.style.cssText="background-color:transparent;color:currentColor;border:0;padding:0;outline:0;max-width:100%",this.resetSearchInput(!0),this._containerElement.appendChild(e),this._rtl=e.dir===""&&document.dir==="rtl"||e.dir==="rtl"}onfocus(e){this._holderElement.classList.contains(T)||(this._holderElement.classList.add(T),this.showOrSearch(),this._config.onFocus(e,this))}onblur(e){let t=e.relatedTarget;if(this._isMouse&&t&&(t.classList.contains("modal")||t.classList.contains(`${p}menu`))){this._searchInput.focus();return}this.afteronblur(e)}afteronblur(e){this._abortController&&this._abortController.abort();let t=!0;if(this._config.addOnBlur&&this._searchInput.value&&(t=this._enterValue()),this._holderElement.classList.remove(T),this.hideSuggestions(t),this._fireEvents){let i=this.getSelection(),s={selection:i?i.dataset.value:null,input:this._searchInput.value};this._config.onBlur(e,this),this._selectElement.dispatchEvent(new CustomEvent("tags.blur",{bubbles:!0,detail:s}))}}onpaste(e){let i=(e.clipboardData||window.clipboardData).getData("text/plain").replace(/\r\n|\n/g," ");if(i.length>2&&this._config.separator.length){let s=ue(i,this._config.separator).filter(o=>o);if(s.length>1){e.preventDefault();for(let o of s)this._addPastedValue(o)}}}_addPastedValue(e){let t=e,i={};if(this._config.allowNew)i.new=1;else{let s=this.getSelection();if(!s)return;e=s.getAttribute(b),t=s.dataset.label}this._config.confirmAdd(e,this).then(()=>{this._add(t,e,i)}).catch(()=>{})}oninput(e){let t=this._config.inputFilter(this._searchInput.value);if(t!=this._searchInput.value&&(this._searchInput.value=t),t){let i=t.slice(-1);if(this._config.separator.length&&this._config.separator.includes(i)){this._searchInput.value=this._searchInput.value.slice(0,-1),this._addPastedValue(this._searchInput.value);return}}setTimeout(()=>{this._adjustWidth()}),this.showOrSearch()}onkeydown(e){let t=e.keyCode||e.key,i=e.target;switch(e.keyCode==229&&(t=i.value.charAt(i.selectionStart-1).charCodeAt(0)),t){case 13:case"Enter":e.preventDefault(),this._enterValue();break;case 38:case"ArrowUp":e.preventDefault(),this._keyboardNavigation=!0,this._moveSelection(k);break;case 40:case"ArrowDown":e.preventDefault(),this._keyboardNavigation=!0,this.isDropdownVisible()?this._moveSelection(A):this.showOrSearch(!1);break;case 8:case"Backspace":let s=this.getLastItem();this._searchInput.value.length===0&&s&&this._config.confirmClear(s,this).then(()=>{this.removeLastItem(),this._adjustWidth(),this.showOrSearch()}).catch(()=>{});break;case 27:case"Escape":this._searchInput.focus(),this.hideSuggestions();break}}onmousemove(e){this._isMouse=!0,this._keyboardNavigation=!1}onmouseleave(e){this._isMouse=!1,this.removeSelection()}onscroll(e){this._positionMenu()}onresize(e){this._positionMenu()}onclick(e=null){!this.isSingle()&&this.isMaxReached()||this._searchInput.focus()}onreset(e){this.reset()}loadData(e=!1){Object.keys(this._config.items).length>0?this.setData(this._config.items,!0):this.resetSuggestions(!0),this._config.server&&(this._config.liveServer||this._loadFromServer(!e))}_setSelectedAttributes(){let e=this._selectElement.selectedOptions||[];for(let t=0;t<e.length;t++)e[t].value&&!e[t].hasAttribute("selected")&&e[t].setAttribute("selected","selected")}resetState(){this.isDisabled()?(this._holderElement.setAttribute("readonly",""),this._searchInput.setAttribute("disabled",""),this._holderElement.classList.add(J)):(v(this._holderElement,"readonly"),v(this._searchInput,"disabled"),this._holderElement.classList.remove(J))}resetSuggestions(e=!1){this._setSelectedAttributes();let t=s=>{let o={value:s.getAttribute("value"),label:s.textContent,disabled:s.disabled,selected:s.selected,title:s.title,data:Object.assign({disabled:s.disabled},s.dataset)};return this._config.valueField!=="value"&&(o[this._config.valueField]=o.value),this._config.labelField!=="label"&&(o[this._config.labelField]=o.label),o},i=Array.from(this._selectElement.children).filter(s=>s.hasAttribute("label")||!s.disabled||this._config.showDisabled).map(s=>s.hasAttribute("label")?{group:s.getAttribute("label"),items:Array.from(s.children).map(o=>t(o))}:t(s));this.setData(i,e)}_enterValue(){let e=this.getSelection();if(e)return e.click(),!0;if(this._config.allowNew&&this._searchInput.value){let t=this._searchInput.value;return this._config.confirmAdd(t,this).then(()=>{this._add(t,t,{new:1})}).catch(()=>{}),!0}return!1}_loadFromServer(e=!1){this._abortController&&this._abortController.abort(),this._abortController=new AbortController;let t=this._selectElement.dataset.serverParams||{};typeof t=="string"&&(t=JSON.parse(t));let i=Object.assign({},this._config.serverParams,t);if(i[this._config.queryParam]=this._searchInput.value,this._config.noCache&&(i.t=Date.now()),i.related){let r=document.getElementById(i.related);if(r){i.related=r.value;let a=r.getAttribute("name");a&&(i[a]=r.value)}}let s=new URLSearchParams(i),o=this._config.server,l=Object.assign(this._config.fetchOptions,{method:this._config.serverMethod||"GET",signal:this._abortController.signal});l.method==="POST"?l.body=s:o+=`?${s.toString()}`,this._holderElement.classList.add(j),fetch(o,l).then(r=>this._config.onServerResponse(r,this)).then(r=>{let a=me(this._config.serverDataKey,r)||r;this.setData(a,!e),this._abortController=null,e&&this._showSuggestions()}).catch(r=>{this._config.onServerError(r,this._abortController.signal,this)}).finally(r=>{this._holderElement.classList.remove(j)})}_add(e,t=null,i={}){if(!i.value&&t&&(i.value=t),!this.canAdd(e,i))return null;let s=this.addItem(e,t,i);return this._resetHtmlState(),this._config.keepOpen?this._showSuggestions():this.resetSearchInput(),s}_isItemEnabled(e){if(e.style.display==="none")return!1;let t=e.firstElementChild;return t.tagName==="A"&&!t.classList.contains("disabled")}_moveSelection(e=A,t=null){let i=this.getSelection(),s=t;if(i){let o=e===A?"nextSibling":"previousSibling";s=i.parentNode;do s=s[o];while(s&&!this._isItemEnabled(s));s?i.classList.remove(...this._activeClasses()):i&&(s=i.parentElement)}else{if(e===k)return s;if(!s)for(s=this._dropElement.firstChild;s&&!this._isItemEnabled(s);)s=s.nextSibling}if(s){let o=s.offsetHeight,l=s.offsetTop,r=s.parentNode,a=r.offsetHeight,c=r.scrollHeight,h=r.offsetTop;if(o===0&&setTimeout(()=>{r.scrollTop=0}),e===k){let d=l-h>10?l-h:0;r.scrollTop=d}else l+o-(a+r.scrollTop)>0&&o>0&&(r.scrollTop=l+o-a+1,r.scrollTop+a>=c-10&&(r.scrollTop=l-h));let u=s.querySelector("a");u.classList.add(...this._activeClasses()),this._searchInput.setAttribute("aria-activedescendant",u.id),this._config.updateOnSelect&&(this._searchInput.value=u.dataset.label,this._adjustWidth())}else this._searchInput.setAttribute("aria-activedescendant","");return s}_adjustWidth(){this._holderElement.classList.remove(z),this._searchInput.value?this._searchInput.size=this._searchInput.value.length:this.getSelectedValues().length?(this._searchInput.placeholder="",this._searchInput.size=1):(this._searchInput.size=this._config.placeholder.length>0?this._config.placeholder.length:1,this._searchInput.placeholder=this._config.placeholder,this._holderElement.classList.add(z));let e=this._searchInput.value||this._searchInput.placeholder;if(e.length>0){let t=K(e,this._holderElement)+20;this._searchInput.style.width=`${t}px`}}_buildSuggestions(e){for(;this._dropElement.lastChild;)this._dropElement.removeChild(this._dropElement.lastChild);let t=0,i=1;for(let s=0;s<e.length;s++){let o=e[s];if(o){if(o.group&&o.items){let l=m("li");l.setAttribute("role","presentation"),l.dataset.id=""+i;let r=m("span");if(l.append(r),r.classList.add("dropdown-header","text-truncate"),r.innerHTML=this._config.sanitizer(o.group),this._dropElement.appendChild(l),o.items)for(let a=0;a<o.items.length;a++){let c=o.items[a];c.group_id=i,this._buildSuggestionsItem(o.items[a],t),t++}i++}this._buildSuggestionsItem(o,t),t++}}if(this._config.notFoundMessage){let s=m("li");s.setAttribute("role","presentation"),s.classList.add(`${p}not-found`),s.innerHTML='<span class="dropdown-item"></span>',this._dropElement.appendChild(s)}}_buildSuggestionsItem(e,t){if(!e[this._config.valueField])return;let i=e[this._config.valueField],s=e[this._config.labelField],o=this._config.onRenderItem(e,s,this),l=m("li");l.setAttribute("role","menuitem"),e.group_id&&l.setAttribute("data-group-id",`${e.group_id}`),e.title&&(l.setAttribute("title",e.title),l.setAttribute("data-bs-placement","left"));let r=m("a");l.append(r),r.id=`${this._dropElement.id}-${t}`,r.classList.add("dropdown-item","text-truncate"),e.disabled&&r.classList.add("disabled"),r.setAttribute(b,i),r.dataset.label=s;let a={};this._config.searchFields.forEach(h=>{a[h]=e[h]}),r.dataset.searchData=JSON.stringify(a),r.setAttribute("href","#"),r.innerHTML=o,this._dropElement.appendChild(l);let c=this._getBootstrapVersion()===5;e.title&&y&&c&&y.getOrCreateInstance(l),r.addEventListener("mouseenter",h=>{this._keyboardNavigation||(this.removeSelection(),l.querySelector("a").classList.add(...this._activeClasses()))}),r.addEventListener("mousedown",h=>{h.preventDefault()}),r.addEventListener("click",h=>{h.preventDefault(),h.stopPropagation(),this._config.confirmAdd(i,this).then(()=>{this._add(s,i,e.data),this._config.onSelectItem(e,this)}).catch(()=>{})})}initialOptions(){return this._selectElement.querySelectorAll("option[data-init]")}_removeSelectedAttrs(){this._selectElement.querySelectorAll("option").forEach(e=>{v(e,"selected")})}reset(){this.removeAll(),this._fireEvents=!1;let e=this.initialOptions();this._removeSelectedAttrs();for(let t=0;t<e.length;t++){let i=e[t],s=Object.assign({},{disabled:i.hasAttribute("disabled")},i.dataset);this.addItem(i.textContent,i.value,s)}this._resetHtmlState(),this._fireEvents=!0}resetSearchInput(e=!1){if(this._searchInput.value="",e||this._adjustWidth(),this._checkMax(),this.isSingle()&&!e){document.activeElement.blur(),this.hideSuggestions();return}e||(this._shouldShow()||this.hideSuggestions(),this._searchInput===document.activeElement&&this._searchInput.dispatchEvent(new Event("input")))}_checkMax(){this.isMaxReached()?(this._holderElement.classList.add(B),this._searchInput.style.visibility="hidden"):this._searchInput.style.visibility=="hidden"&&(this._searchInput.style.visibility="visible")}getSelectedValues(){let e=this._selectElement.querySelectorAll("option[selected]");return Array.from(e).map(t=>t.value)}getAvailableValues(){let e=this._selectElement.querySelectorAll("option");return Array.from(e).map(t=>t.value)}showOrSearch(e=!0){if(e&&!this._shouldShow()){this.hideSuggestions(!1);return}this._config.liveServer?this._searchFunc():this._showSuggestions()}hideSuggestions(e=!0){this._dropElement.classList.remove(S),w(this._searchInput,{"aria-expanded":"false"}),this.removeSelection(),e&&this._holderElement.classList.remove(_)}toggleSuggestions(e=!0,t=!0){this._dropElement.classList.contains(S)?this.hideSuggestions(t):this.showOrSearch(e)}_shouldShow(){return this.isDisabled()||this.isMaxReached()?!1:this._searchInput.value.length>=this._config.suggestionsThreshold}_showSuggestions(){if(this._searchInput.style.visibility=="hidden")return;let e=F(this._searchInput.value),t={},i=this._dropElement.querySelectorAll("li"),s=0,o=null,l=!1,r={};for(let a=0;a<i.length;a++){let c=i[a],h=c.firstElementChild;if(h instanceof HTMLSpanElement){c.dataset.id&&(r[c.dataset.id]=!1),L(c);continue}if(h.classList.remove(...this._activeClasses()),!this._config.allowSame){let f=h.getAttribute(b);if(t[f]=t[f]||0,this._findOption(h.getAttribute(b),"[selected]",t[f]++)){L(c);continue}}let u=this._config.showAllSuggestions||e.length===0,d=e.length==0&&this._config.suggestionsThreshold===0;if(!u&&e.length>0){let f=JSON.parse(h.dataset.searchData);this._config.searchFields.forEach(g=>{let x=F(f[g]),O=!1;if(this._config.fuzzy)O=fe(x,e);else{let W=x.indexOf(e);O=this._config.startsWith?W===0:W>=0}O&&(d=!0)})}let E=d||e.length===0;if(u||d?(s++,U(c),c.dataset.groupId&&(r[c.dataset.groupId]=!0),!o&&this._isItemEnabled(c)&&E&&(o=c),this._config.maximumItems>0&&s>this._config.maximumItems&&L(c)):L(c),this._config.highlightTyped){let f=h.textContent,g=F(f).indexOf(e),x=f.substring(0,g)+`<mark class="${this._config.highlightClass}">${f.substring(g,g+e.length)}</mark>`+f.substring(g+e.length,f.length);h.innerHTML=x}this._isItemEnabled(c)&&(l=!0)}if(!this._config.allowNew&&!(e.length===0&&!l)&&this._holderElement.classList.add(_),this._config.allowNew&&this._config.regex&&this.isInvalid()&&this._holderElement.classList.remove(_),Array.from(i).filter(a=>a.dataset.id).forEach(a=>{r[a.dataset.id]===!0&&U(a)}),l&&(this._holderElement.classList.remove(_),o&&this._config.autoselectFirst&&(this.removeSelection(),this._moveSelection(A,o))),s===0)if(this._config.notFoundMessage){let a=this._dropElement.querySelector(`.${p}not-found`);a.style.display="block";let c=this._config.notFoundMessage.replace("{{tag}}",this._searchInput.value);a.innerHTML=`<span class="dropdown-item">${c}</span>`,this._showDropdown()}else this.hideSuggestions(!1);else this._showDropdown()}_showDropdown(){let e=this._dropElement.classList.contains(S);e||(this._dropElement.classList.add(S),w(this._searchInput,{"aria-expanded":"true"})),this._positionMenu(e)}_positionMenu(e=!1){let t=this._rtl,i=this._config.fixed,s=this._config.fullWidth,o=this._searchInput.getBoundingClientRect(),l=this._holderElement.getBoundingClientRect(),r=0,a=0;if(i?s?(r=l.x,a=l.y+l.height+2):(r=o.x,a=o.y+o.height):s?(r=0,a=l.height+2):(r=this._searchInput.offsetLeft,a=this._searchInput.offsetHeight+this._searchInput.offsetTop),t&&!s&&(r-=this._dropElement.offsetWidth-o.width),!s){let u=Math.min(window.innerWidth,document.body.offsetWidth),d=t?o.x+o.width-this._dropElement.offsetWidth-1:u-1-(o.x+this._dropElement.offsetWidth);d<0&&(r=t?r-d:r+d)}s&&(this._dropElement.style.width=`${this._holderElement.offsetWidth}px`),e||(this._dropElement.style.transform="unset"),Object.assign(this._dropElement.style,{left:`${r}px`,top:`${a}px`});let c=this._dropElement.getBoundingClientRect(),h=window.innerHeight;if(c.y+c.height>h||this._dropElement.style.transform.includes("translateY")){let u=s?l.height+4:o.height;this._dropElement.style.transform=`translateY(calc(-100.1% - ${u}px))`}}_getBootstrapVersion(){let e=5,t=window.jQuery;return t&&t.fn.tooltip&&t.fn.tooltip.Constructor&&(e=parseInt(t.fn.tooltip.Constructor.VERSION.charAt(0))),e}_isSelected(e){return!!Array.from(this._selectElement.querySelectorAll("option")).find(s=>s.textContent==e&&s.getAttribute("selected"))}_isSelectable(e,t){let i=Array.from(this._selectElement.querySelectorAll("option")),s=t.value?i.filter(o=>o.value==t.value):i.filter(o=>o.textContent==e);return!(s.length>0&&!s.find(l=>!l.getAttribute("selected")))}hasItem(e){for(let t of this._config.items){let i=t.items||[t];for(let s of i)if(s[this._config.labelField]==e)return!0}return!1}getItem(e){for(let t of this._config.items){let i=t.items||[t];for(let s of i)if(s[this._config.valueField]==e)return s}return null}_validateRegex(e){return new RegExp(this._config.regex.trim()).test(e)}getSelection(){return this._dropElement.querySelector(`a.${q}`)}removeSelection(){let e=this.getSelection();e&&e.classList.remove(...this._activeClasses())}_activeClasses(){return[...this._config.activeClasses,q]}getActiveSelection(){return this.getSelection()}removeActiveSelection(){return this.removeSelection()}removeAll(){this.getSelectedValues().forEach(t=>{let i=this.removeItem(t,!0)}),this._adjustWidth()}removeLastItem(e=!1){let t=this.getLastItem();t&&this.removeItem(t,e)}getLastItem(){let e=this._containerElement.querySelectorAll(`span.${p}badge`);return e.length?e[e.length-1].getAttribute(b):void 0}disable(){this._selectElement.setAttribute("disabled",""),this.resetState()}enable(){v(this._selectElement,"disabled"),this.resetState()}isDisabled(){return this._selectElement.hasAttribute("disabled")||this._selectElement.disabled||this._selectElement.hasAttribute("readonly")}isDropdownVisible(){return this._dropElement.classList.contains(S)}isInvalid(){return this._holderElement.classList.contains(_)}isSingle(){return!this._selectElement.hasAttribute("multiple")}isMaxReached(){return this._config.max&&this.getSelectedValues().length>=this._config.max}canAdd(e,t={}){let i=this.cannotAddReason(e,t);return i==="ok"?!0:(i.includes("invalid-")&&this._holderElement.classList.add(_),!1)}cannotAddReason(e,t={}){if(!e)return"no-text";if(t.new&&!this._config.allowNew)return"not-allow-new";if(!t.new&&!this._config.liveServer&&!this.hasItem(e))return"no-item";if(this.isDisabled())return"is-disabled";if(!this.isSingle()&&!this._config.allowSame){if(t.new){if(this._isSelected(e))return"already-selected"}else if(!this._isSelectable(e,t))return"not-selectable"}return this.isMaxReached()?"max-reached":this._config.regex&&t.new&&!this._validateRegex(e)?"invalid-regex":this._config.onCanAdd&&this._config.onCanAdd(e,t,this)===!1?"invalid-can-add":"ok"}getData(){return this._config.items}setData(e,t=!1){this._fireEvents=!1,Array.isArray(e)||(e=Object.entries(e).map(([i,s])=>({value:i,label:s}))),this._config.items!=e&&(this._config.items=e),t&&(this._removeSelectedAttrs(),e.reduce((s,o)=>s.concat(o.group?o.items:[o]),[]).forEach(s=>{let o=s[this._config.valueField],l=s[this._config.labelField];if(o&&(s.selected||this._config.selected.includes(o))){let r=this.addItem(l,o,s.data);r&&r.setAttribute("data-init","true")}})),this._buildSuggestions(e),this._resetHtmlState(),this._fireEvents=!0,this._config.onDataLoaded(e,this),this._selectElement.dispatchEvent(new CustomEvent("tags.loaded",{bubbles:!0,detail:e}))}_findOption(e=null,t="",i=0){let o=`option${e===null?"":`[value="${CSS.escape(e)}"]`}${t}`;return this._selectElement.querySelectorAll(o)[i]||null}setItem(e,t={}){let i=null;if(!this._config.allowSame&&this._findOption(e,"[selected]"))return;let s=this._findOption(e,":not([selected])");if(s)i=this.addItem(s.textContent,s.value,t);else{let o=this.getItem(e);if(o){let l=o[this._config.valueField],r=o[this._config.labelField];i=this.addItem(r,l,t)}}return this._adjustWidth(),this._checkMax(),i}addItem(e,t=null,i={}){t||(t=e),this.isSingle()&&this.getSelectedValues().length&&this.removeLastItem(!0);let s=this._findOption(t,":not([selected])");if(!s){s=m("option"),s.value=t,s.innerText=e;for(let[o,l]of Object.entries(i))s.dataset[o]=l;this._selectElement.appendChild(s),this._config.onCreateItem(s,this)}return s&&(i=Object.assign({title:s.getAttribute("title")},s.dataset,i)),s.setAttribute("selected","selected"),s.selected=!0,this._createBadge(e,t,i),this._fireEvents&&this._selectElement.dispatchEvent(new Event("change",{bubbles:!0})),s}_resetHtmlState(){let e=this._selectElement.innerHTML;this._selectElement.innerHTML="",this._selectElement.innerHTML=e,this._adjustWidth()}_createBadge(e,t=null,i={}){let s=this._getBootstrapVersion()===5,o=i.disabled&&Y(i.disabled),l=this._config.allowClear&&!o,r=this._config.allowHtml?e:this._config.sanitizer(e),a=m("span"),c=[`${p}badge`],h=this.isSingle()&&!this._config.singleBadge;if(!h){c.push("badge");let d=this._config.badgeStyle;i.badgeStyle&&(d=i.badgeStyle),i.badgeClass&&c.push(...i.badgeClass.split(" ")),this._config.baseClass?c.push(...this._config.baseClass.split(" ")):s?c=[...c,`bg-${d}`,"text-truncate"]:c=[...c,`badge-${d}`],a.style.maxWidth="100%"}o&&c.push("disabled","opacity-50");let u=h?0:2;if(a.style.margin=`${u}px 6px ${u}px 0px`,a.style.marginBlock=`${u}px`,a.style.marginInline="0px 6px",a.style.display="flex",a.style.alignItems="center",i.backgroundColor&&a.style.setProperty("background-color",i.backgroundColor,"important"),i.color&&a.style.setProperty("color",i.color,"important"),a.classList.add(...c),a.setAttribute(b,t),i.title&&a.setAttribute("title",i.title),l){let d=c.includes("text-dark")||i.color&&!he(i.color)||h?"btn-close":"btn-close btn-close-white",E="margin-inline: 0px 6px;",f="left";this._config.clearEnd&&(f="right"),f=="right"&&(E="margin-inline: 6px 0px;");let g=s?'<button type="button" style="font-size:0.65em;'+E+'" class="'+d+'" aria-label="'+this._config.clearLabel+'"></button>':'<button type="button" style="font-size:1em;'+E+'text-shadow:none;color:currentColor;transform:scale(1.2);float:none" class="close" aria-label="'+this._config.clearLabel+'"><span aria-hidden="true">&times;</span></button>';r=f=="left"?g+r:r+g}a.innerHTML=r,this._containerElement.insertBefore(a,this._searchInput),i.title&&y&&s&&y.getOrCreateInstance(a),l&&a.querySelector("button").addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),this.isDisabled()||this._config.confirmClear(t,this).then(()=>{this.removeItem(t),document.activeElement.blur(),this._adjustWidth()}).catch(()=>{})})}getHolder(){return this._holderElement}clear(){this.hideSuggestions(),this.reset()}updateData(e){this.setData(e,!1),this.reset()}removeItem(e,t=!1){let i=CSS.escape(e),s=this._containerElement.querySelectorAll("span["+b+'="'+i+'"]');if(!s.length)return!1;let o=s.length-1,l=s[o];l&&(l.dataset.bsOriginalTitle&&y.getOrCreateInstance(l).dispose(),l.remove());let r=this._findOption(e,"[selected]",o);return r&&(v(r,"selected"),r.selected=!1,this._fireEvents&&!t&&this._selectElement.dispatchEvent(new Event("change",{bubbles:!0}))),this._searchInput.style.visibility=="hidden"&&!this.isMaxReached()&&(this._searchInput.style.visibility="visible",this._holderElement.classList.remove(B)),t||this._config.onClearItem(e,this),!0}},Q=D;var M=n=>typeof n=="string";var I=n=>n.split(".").reduce((e,t)=>e[t],window);var Z=n=>{M(n)&&(n=n[0]==="{"?JSON.parse(n):I(n));for(let[e,t]of Object.entries(n))if(t&&typeof t=="object"){let i=t.__fn;M(i)?n[e]=I(i):Z(t)}return n},ee=Z;var te=n=>n?(n[0]!=="{"&&n.includes(":")&&(n=`{${n.replace(/([^:\s{,]*)\s*:\s*('[^']*'|"[^"]*"|([\[].*?[\]])|[^,'"{\[]*)/g,(e,t,i)=>`"${t.replace(/['"]/g,"")}":${i.includes('"')?i:i.replace(/'/g,'"')}`)}}`),n[0]==="{"?JSON.parse(n):I(n)):{};var ge=n=>{let e=n;do{if(e.nextSibling){n.parsedCallback();return}e=e.parentNode}while(e);setTimeout(()=>{n.parsedCallback()})},se=ge;var H="__fe_id";window[H]=window[H]||0;var $=new Map,N=class extends HTMLElement{_restoreContent(){this.id=this.id||`fe-${window[H]++}`;let e=$.get(this.id);e?e!==this.innerHTML&&(this.innerHTML=e):$.set(this.id,this.innerHTML)}connectedCallback(){this._t&&clearTimeout(this._t),se(this)}disconnectedCallback(){this.disconnected(),this._t=setTimeout(()=>{this.destroyed(),this.config=null,document.getElementById(this.id)||$.delete(this.id)},1e3)}parsedCallback(){this.config||(this._restoreContent(),this.config=ee(te(this.dataset.config)),this.created()),this.connected()}created(){}destroyed(){}connected(){}disconnected(){}},ie=N;var ne=(n,e)=>{e=typeof e=="string"?[e]:e,e.forEach(t=>{n.querySelectorAll(t).forEach(i=>{i.remove()})})};var P=class extends ie{get el(){return this.querySelector("select")}get value(){return this.el.value}created(){ne(this,"div.dropdown"),this.tags=new Q(this.el,this.config)}destroyed(){this.tags.dispose(),this.tags=null}},V=P;var oe=customElements,le=(n,e)=>{oe.get(n)||oe.define(n,e)};var re=".form-control-focus,.form-control:focus{color:var(--bs-body-color, #212529);background-color:var(--bs-form-control-bg, var(--bs-body-bg, #fff));border-color:rgba(var(--bs-primary-rgb, 13, 110, 253), 0.5);outline:0;box-shadow:0 0 0 var(--bs-focus-ring-width) rgba(var(--bs-primary-rgb, 13, 110, 253), 0.25)}.was-validated :valid+.form-control-focus,.was-validated :valid+.form-control:focus{border-color:var(--bs-success, #198754);box-shadow:0 0 0 var(--bs-focus-ring-width) rgba(var(--bs-success-rgb, 25, 135, 84), 0.25)}.was-validated :invalid+.form-control-focus,.was-validated :invalid+.form-control:focus{border-color:var(--bs-danger, #dc3545);box-shadow:0 0 0 var(--bs-focus-ring-width, 0.25rem) rgba(var(--bs-danger-rgb, 220, 53, 69), 0.25)}.form-floating .form-control.form-placeholder-shown:not(.form-control-focus)~label{opacity:unset;transform:unset}.form-floating .form-control~label{z-index:unset}.form-control-disabled{background-color:var(--bs-form-control-disabled-bg, var(--bs-secondary-bg, #e9ecef));opacity:1}.tags-menu mark{text-decoration:underline;background:none;color:currentColor;padding:0}.form-control.is-max-reached{background-image:none}";var ae=(n,e)=>{if(!document.head.querySelector(`#${n}-style`)){let t=document.createElement("style");t.id=`${n}-style`,t.innerText=e,document.head.append(t)}};ae("bs-tags",re);le("bs-tags",V);var je=V;})();
/*! Bundled license information:

bootstrap5-tags/tags.js:
  (**
   * Bootstrap 5 (and 4!) tags
   * https://github.com/lekoala/bootstrap5-tags
   * @license MIT
   *)
*/
