"use strict";(()=>{var et=Object.create;var we=Object.defineProperty;var tt=Object.getOwnPropertyDescriptor;var nt=Object.getOwnPropertyNames;var it=Object.getPrototypeOf,rt=Object.prototype.hasOwnProperty;var st=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(n,t)=>(typeof require<"u"?require:n)[t]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var at=(e,n,t,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of nt(n))!rt.call(e,r)&&r!==t&&we(e,r,{get:()=>n[r],enumerable:!(i=tt(n,r))||i.enumerable});return e};var ot=(e,n,t)=>(t=e!=null?et(it(e)):{},at(n||!e||!e.__esModule?we(t,"default",{value:e,enumerable:!0}):t,e));var lt=()=>!0,O=class{root;currentNode;nodeType;filter;constructor(e,n,t){this.root=e,this.currentNode=e,this.nodeType=n,this.filter=t||lt}isAcceptableNode(e){let n=e.nodeType;return!!((n===Node.ELEMENT_NODE?1:n===Node.TEXT_NODE?4:0)&this.nodeType)&&this.filter(e)}nextNode(){let e=this.root,n=this.currentNode,t;for(;;){for(t=n.firstChild;!t&&n&&n!==e;)t=n.nextSibling,t||(n=n.parentNode);if(!t)return null;if(this.isAcceptableNode(t))return this.currentNode=t,t;n=t}}previousNode(){let e=this.root,n=this.currentNode,t;for(;;){if(n===e)return null;if(t=n.previousSibling,t)for(;n=t.lastChild;)t=n;else t=n.parentNode;if(!t)return null;if(this.isAcceptableNode(t))return this.currentNode=t,t;n=t}}previousPONode(){let e=this.root,n=this.currentNode,t;for(;;){for(t=n.lastChild;!t&&n&&n!==e;)t=n.previousSibling,t||(n=n.parentNode);if(!t)return null;if(this.isAcceptableNode(t))return this.currentNode=t,t;n=t}}},Z="\u200B",q=navigator.userAgent,Ne=/Mac OS X/.test(q),Fe=/Windows NT/.test(q),He=/iP(?:ad|hone|od)/.test(q)||Ne&&!!navigator.maxTouchPoints,dt=/Android/.test(q),ct=/Gecko\//.test(q),ie=/Edge\//.test(q),ht=!ie&&/WebKit\//.test(q),A=Ne||He?"Meta-":"Ctrl-",pe=ht,ft="onbeforeinput"in document&&"inputType"in new InputEvent("input"),U=/[^ \t\r\n]/,ut=/^(?:#text|A(?:BBR|CRONYM)?|B(?:R|D[IO])?|C(?:ITE|ODE)|D(?:ATA|EL|FN)|EM|FONT|HR|I(?:FRAME|MG|NPUT|NS)?|KBD|Q|R(?:P|T|UBY)|S(?:AMP|MALL|PAN|TR(?:IKE|ONG)|U[BP])?|TIME|U|VAR|WBR)$/,pt=new Set(["BR","HR","IFRAME","IMG","INPUT"]),mt=0,me=1,ze=2,Ve=3,ne=new WeakMap,gt=()=>{ne=new WeakMap},z=e=>pt.has(e.nodeName),_e=e=>{switch(e.nodeType){case 3:return me;case 1:case 11:if(ne.has(e))return ne.get(e);break;default:return mt}let n;return Array.from(e.childNodes).every(g)?ut.test(e.nodeName)?n=me:n=ze:n=Ve,ne.set(e,n),n},g=e=>_e(e)===me,F=e=>_e(e)===ze,j=e=>_e(e)===Ve,p=(e,n,t)=>{let i=document.createElement(e);if(n instanceof Array&&(t=n,n=null),n)for(let r in n){let s=n[r];s!==void 0&&i.setAttribute(r,s)}return t&&t.forEach(r=>i.appendChild(r)),i},We=(e,n)=>z(e)||e.nodeType!==n.nodeType||e.nodeName!==n.nodeName?!1:e instanceof HTMLElement&&n instanceof HTMLElement?e.nodeName!=="A"&&e.className===n.className&&e.style.cssText===n.style.cssText:!0,ge=(e,n,t)=>{if(e.nodeName!==n)return!1;for(let i in t)if(!("getAttribute"in e)||e.getAttribute(i)!==t[i])return!1;return!0},v=(e,n,t,i)=>{for(;e&&e!==n;){if(ge(e,t,i))return e;e=e.parentNode}return null},xe=(e,n)=>{let t=e.childNodes;for(;n&&e instanceof Element;)e=t[n-1],t=e.childNodes,n=t.length;return e},Ke=(e,n)=>{let t=e;if(t instanceof Element){let i=t.childNodes;if(n<i.length)t=i[n];else{for(;t&&!t.nextSibling;)t=t.parentNode;t&&(t=t.nextSibling)}}return t},w=e=>e instanceof Element||e instanceof DocumentFragment?e.childNodes.length:e instanceof CharacterData?e.length:0,S=e=>{let n=document.createDocumentFragment(),t=e.firstChild;for(;t;)n.appendChild(t),t=e.firstChild;return n},T=e=>{let n=e.parentNode;return n&&n.removeChild(e),e},L=(e,n)=>{let t=e.parentNode;t&&t.replaceChild(n,e)},vt=e=>e instanceof Element?e.nodeName==="BR":U.test(e.data),ae=(e,n)=>{let t=e.parentNode;for(;g(t);)t=t.parentNode;let i=new O(t,5,vt);return i.currentNode=e,!!i.nextNode()||n&&!i.previousNode()},fe=(e,n)=>{let t=new O(e,4),i,r;for(;i=t.nextNode();)for(;(r=i.data.indexOf(Z))>-1&&(!n||i.parentNode!==n);)if(i.length===1){let s=i,a=s.parentNode;for(;a&&(a.removeChild(s),t.currentNode=a,!(!g(a)||w(a)));)s=a,a=s.parentNode;break}else i.deleteData(r,1)},St=0,Ct=1,Nt=2,_t=3,M=(e,n,t)=>{let i=document.createRange();if(i.selectNode(n),t){let r=e.compareBoundaryPoints(_t,i)>-1,s=e.compareBoundaryPoints(Ct,i)<1;return!r&&!s}else{let r=e.compareBoundaryPoints(St,i)<1,s=e.compareBoundaryPoints(Nt,i)>-1;return r&&s}},b=e=>{let{startContainer:n,startOffset:t,endContainer:i,endOffset:r}=e;for(;!(n instanceof Text);){let s=n.childNodes[t];if(!s||z(s)){if(t&&(s=n.childNodes[t-1],s instanceof Text)){let a=s,o;for(;!a.length&&(o=a.previousSibling)&&o instanceof Text;)a.remove(),a=o;n=a,t=a.data.length}break}n=s,t=0}if(r)for(;!(i instanceof Text);){let s=i.childNodes[r-1];if(!s||z(s)){if(s&&s.nodeName==="BR"&&!ae(s,!1)){r-=1;continue}break}i=s,r=w(i)}else for(;!(i instanceof Text);){let s=i.firstChild;if(!s||z(s))break;i=s}e.setStart(n,t),e.setEnd(i,r)},V=(e,n,t,i)=>{let r=e.startContainer,s=e.startOffset,a=e.endContainer,o=e.endOffset,l;for(n||(n=e.commonAncestorContainer),t||(t=n);!s&&r!==n&&r!==i;)l=r.parentNode,s=Array.from(l.childNodes).indexOf(r),r=l;for(;!(a===t||a===i||(a.nodeType!==3&&a.childNodes[o]&&a.childNodes[o].nodeName==="BR"&&!ae(a.childNodes[o],!1)&&(o+=1),o!==w(a)));)l=a.parentNode,o=Array.from(l.childNodes).indexOf(a)+1,a=l;e.setStart(r,s),e.setEnd(a,o)},Be=(e,n,t)=>{let i=v(e.endContainer,t,n);if(i&&(i=i.parentNode)){let r=e.cloneRange();V(r,i,i,t),r.endContainer===i&&(e.setStart(r.endContainer,r.endOffset),e.setEnd(r.endContainer,r.endOffset))}return e},_=e=>{let n=null;if(e instanceof Text)return e;if(g(e)){let t=e.firstChild;if(pe)for(;t&&t instanceof Text&&!t.data;)e.removeChild(t),t=e.firstChild;t||(pe?n=document.createTextNode(Z):n=document.createTextNode(""))}else if(e instanceof Element&&!e.querySelector("BR")){n=p("BR");let t=e,i;for(;(i=t.lastElementChild)&&!g(i);)t=i}if(n)try{e.appendChild(n)}catch{}return e},D=(e,n)=>{let t=null;return Array.from(e.childNodes).forEach(i=>{let r=i.nodeName==="BR";!r&&g(i)?(t||(t=p("DIV")),t.appendChild(i)):(r||t)&&(t||(t=p("DIV")),_(t),r?e.replaceChild(t,i):e.insertBefore(t,i),t=null),j(i)&&D(i,n)}),t&&e.appendChild(_(t)),e},y=(e,n,t,i)=>{if(e instanceof Text&&e!==t){if(typeof n!="number")throw new Error("Offset must be a number to split text node!");if(!e.parentNode)throw new Error("Cannot split text node with no parent!");return y(e.parentNode,e.splitText(n),t,i)}let r=typeof n=="number"?n<e.childNodes.length?e.childNodes[n]:null:n,s=e.parentNode;if(!s||e===t||!(e instanceof Element))return r;let a=e.cloneNode(!1);for(;r;){let o=r.nextSibling;a.appendChild(r),r=o}return e instanceof HTMLOListElement&&v(e,i,"BLOCKQUOTE")&&(a.start=(+e.start||1)+e.childNodes.length-1),_(e),_(a),s.insertBefore(a,e.nextSibling),y(s,a,t,i)},qe=(e,n)=>{let t=e.childNodes,i=t.length,r=[];for(;i--;){let s=t[i],a=i?t[i-1]:null;if(a&&g(s)&&We(s,a))n.startContainer===s&&(n.startContainer=a,n.startOffset+=w(a)),n.endContainer===s&&(n.endContainer=a,n.endOffset+=w(a)),n.startContainer===e&&(n.startOffset>i?n.startOffset-=1:n.startOffset===i&&(n.startContainer=a,n.startOffset=w(a))),n.endContainer===e&&(n.endOffset>i?n.endOffset-=1:n.endOffset===i&&(n.endContainer=a,n.endOffset=w(a))),T(s),s instanceof Text?a.appendData(s.data):r.push(S(s));else if(s instanceof Element){let o;for(;o=r.pop();)s.appendChild(o);qe(s,n)}}},Q=(e,n)=>{let t=e instanceof Text?e.parentNode:e;if(t instanceof Element){let i={startContainer:n.startContainer,startOffset:n.startOffset,endContainer:n.endContainer,endOffset:n.endOffset};qe(t,i),n.setStart(i.startContainer,i.startOffset),n.setEnd(i.endContainer,i.endOffset)}},X=(e,n,t,i)=>{let r=n,s,a;for(;(s=r.parentNode)&&s!==i&&s instanceof Element&&s.childNodes.length===1;)r=s;T(r),a=e.childNodes.length;let o=e.lastChild;o&&o.nodeName==="BR"&&(e.removeChild(o),a-=1),e.appendChild(S(n)),t.setStart(e,a),t.collapse(!0),Q(e,t)},I=(e,n)=>{let t=e.previousSibling,i=e.firstChild,r=e.nodeName==="LI";if(!(r&&(!i||!/^[OU]L$/.test(i.nodeName)))){if(t&&We(t,e)){if(!j(t))if(r){let a=p("DIV");a.appendChild(S(t)),t.appendChild(a)}else return;T(e);let s=!j(e);t.appendChild(S(e)),s&&D(t,n),i&&I(i,n)}else if(r){let s=p("DIV");e.insertBefore(s,i),_(s)}}},De={"font-weight":{regexp:/^bold|^700/i,replace(){return p("B")}},"font-style":{regexp:/^italic/i,replace(){return p("I")}},"font-family":{regexp:U,replace(e,n){return p("SPAN",{class:e.fontFamily,style:"font-family:"+n})}},"font-size":{regexp:U,replace(e,n){return p("SPAN",{class:e.fontSize,style:"font-size:"+n})}},"text-decoration":{regexp:/^underline/i,replace(){return p("U")}}},xt=(e,n,t)=>{let i=e.style,r,s;for(let a in De){let o=De[a],l=i.getPropertyValue(a);if(l&&o.regexp.test(l)){let d=o.replace(t.classNames,l);if(d.nodeName===e.nodeName&&d.className===e.className)continue;s||(s=d),r&&r.appendChild(d),r=d,e.style.removeProperty(a)}}return s&&r&&(r.appendChild(S(e)),e.style.cssText?e.appendChild(s):L(e,s)),r||e},te=e=>(n,t)=>{let i=p(e),r=n.attributes;for(let s=0,a=r.length;s<a;s+=1){let o=r[s];i.setAttribute(o.name,o.value)}return t.replaceChild(i,n),i.appendChild(S(n)),i},Tt={1:"10",2:"13",3:"16",4:"18",5:"24",6:"32",7:"48"},bt={STRONG:te("B"),EM:te("I"),INS:te("U"),STRIKE:te("S"),SPAN:xt,FONT:(e,n,t)=>{let i=e,r=i.face,s=i.size,a=i.color,o=t.classNames,l,d,c,h,u;return r&&(l=p("SPAN",{class:o.fontFamily,style:"font-family:"+r}),u=l,h=l),s&&(d=p("SPAN",{class:o.fontSize,style:"font-size:"+Tt[s]+"px"}),u||(u=d),h&&h.appendChild(d),h=d),a&&/^#?([\dA-F]{3}){1,2}$/i.test(a)&&(a.charAt(0)!=="#"&&(a="#"+a),c=p("SPAN",{class:o.color,style:"color:"+a}),u||(u=c),h&&h.appendChild(c),h=c),(!u||!h)&&(u=h=p("SPAN")),n.replaceChild(u,i),h.appendChild(S(i)),h},TT:(e,n,t)=>{let i=p("SPAN",{class:t.classNames.fontFamily,style:'font-family:menlo,consolas,"courier new",monospace'});return n.replaceChild(i,e),i.appendChild(S(e)),i}},Lt=/^(?:A(?:DDRESS|RTICLE|SIDE|UDIO)|BLOCKQUOTE|CAPTION|D(?:[DLT]|IV)|F(?:IGURE|IGCAPTION|OOTER)|H[1-6]|HEADER|L(?:ABEL|EGEND|I)|O(?:L|UTPUT)|P(?:RE)?|SECTION|T(?:ABLE|BODY|D|FOOT|H|HEAD|R)|COL(?:GROUP)?|UL)$/,Et=/^(?:HEAD|META|STYLE)/,ve=(e,n,t)=>{let i=e.childNodes,r=e;for(;g(r);)r=r.parentNode;let s=new O(r,5);for(let a=0,o=i.length;a<o;a+=1){let l=i[a],d=l.nodeName,c=bt[d];if(l instanceof HTMLElement){let h=l.childNodes.length;if(c)l=c(l,e,n);else if(Et.test(d)){e.removeChild(l),a-=1,o-=1;continue}else if(!Lt.test(d)&&!g(l)){a-=1,o+=h-1,e.replaceChild(S(l),l);continue}h&&ve(l,n,t||d==="PRE")}else{if(l instanceof Text){let h=l.data,u=!U.test(h.charAt(0)),f=!U.test(h.charAt(h.length-1));if(t||!u&&!f)continue;if(u){s.currentNode=l;let m;for(;(m=s.previousPONode())&&!(m.nodeName==="IMG"||m instanceof Text&&U.test(m.data));)if(!g(m)){m=null;break}h=h.replace(/^[ \t\r\n]+/g,m?" ":"")}if(f){s.currentNode=l;let m;for(;(m=s.nextNode())&&!(m.nodeName==="IMG"||m instanceof Text&&U.test(m.data));)if(!g(m)){m=null;break}h=h.replace(/[ \t\r\n]+$/g,m?" ":"")}if(h){l.data=h;continue}}e.removeChild(l),a-=1,o-=1}}return e},Se=e=>{let n=e.childNodes,t=n.length;for(;t--;){let i=n[t];i instanceof Element&&!z(i)?(Se(i),g(i)&&!i.firstChild&&e.removeChild(i)):i instanceof Text&&!i.data&&e.removeChild(i)}},re=(e,n,t)=>{let i=e.querySelectorAll("BR"),r=[],s=i.length;for(let a=0;a<s;a+=1)r[a]=ae(i[a],t);for(;s--;){let a=i[s],o=a.parentNode;o&&(r[s]?g(o)||D(o,n):T(a))}},Re=e=>e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;"),se=(e,n)=>{let t=new O(n,1,F);return t.currentNode=e,t},$=(e,n)=>{let t=se(e,n).previousNode();return t!==n?t:null},H=(e,n)=>{let t=se(e,n).nextNode();return t!==n?t:null},Ce=e=>!e.textContent&&!e.querySelector("IMG"),B=(e,n)=>{let t=e.startContainer,i;if(g(t))i=$(t,n);else if(t!==n&&t instanceof HTMLElement&&F(t))i=t;else{let r=xe(t,e.startOffset);i=H(r,n)}return i&&M(e,i,!0)?i:null},K=(e,n)=>{let t=e.endContainer,i;if(g(t))i=$(t,n);else if(t!==n&&t instanceof HTMLElement&&F(t))i=t;else{let r=Ke(t,e.endOffset);if(!r||!n.contains(r)){r=n;let s;for(;s=r.lastChild;)r=s}i=$(r,n)}return i&&M(e,i,!0)?i:null},Ge=e=>e instanceof Text?U.test(e.data):e.nodeName==="IMG",ee=(e,n)=>{let t=e.startContainer,i=e.startOffset,r;if(t instanceof Text){if(i)return!1;r=t}else if(r=Ke(t,i),r&&!n.contains(r)&&(r=null),!r&&(r=xe(t,i),r instanceof Text&&r.length))return!1;let s=B(e,n);if(!s)return!1;let a=new O(s,5,Ge);return a.currentNode=r,!a.previousNode()},oe=(e,n)=>{let t=e.endContainer,i=e.endOffset,r;if(t instanceof Text){let o=t.data.length;if(o&&i<o)return!1;r=t}else r=xe(t,i);let s=K(e,n);if(!s)return!1;let a=new O(s,5,Ge);return a.currentNode=r,!a.nextNode()},Pe=(e,n)=>{let t=B(e,n),i=K(e,n),r;t&&i&&(r=t.parentNode,e.setStart(r,Array.from(r.childNodes).indexOf(t)),r=i.parentNode,e.setEnd(r,Array.from(r.childNodes).indexOf(i)+1))};function W(e,n,t,i){let r=document.createRange();return r.setStart(e,n),t&&typeof i=="number"?r.setEnd(t,i):r.setEnd(e,n),r}var P=(e,n)=>{let{startContainer:t,startOffset:i,endContainer:r,endOffset:s}=e,a;if(t instanceof Text){let l=t.parentNode;if(a=l.childNodes,i===t.length)i=Array.from(a).indexOf(t)+1,e.collapsed&&(r=l,s=i);else{if(i){let d=t.splitText(i);r===t?(s-=i,r=d):r===l&&(s+=1),t=d}i=Array.from(a).indexOf(t)}t=l}else a=t.childNodes;let o=a.length;i===o?t.appendChild(n):t.insertBefore(n,a[i]),t===r&&(s+=a.length-o),e.setStart(t,i),e.setEnd(r,s)},Qe=(e,n,t)=>{let i=document.createDocumentFragment();if(e.collapsed)return i;n||(n=e.commonAncestorContainer),n instanceof Text&&(n=n.parentNode);let r=e.startContainer,s=e.startOffset,a=y(e.endContainer,e.endOffset,n,t),o=0,l=y(r,s,n,t);for(;l&&l!==a;){let d=l.nextSibling;i.appendChild(l),l=d}return r instanceof Text&&a instanceof Text&&(r.appendData(a.data),T(a),a=r,o=s),e.setStart(r,s),a?e.setEnd(a,o):e.setEnd(n,n.childNodes.length),_(n),i},Ue=(e,n,t)=>{e.currentNode=t;let i;for(;i=e[n]();){if(i instanceof Text||z(i))return i;if(!g(i))return null}return null},G=(e,n)=>{let t=B(e,n),i=K(e,n),r=t!==i;t&&i&&(b(e),V(e,t,i,n));let s=Qe(e,null,n);b(e),r&&(i=K(e,n),t&&i&&t!==i&&X(t,i,e,n)),t&&_(t);let a=n.firstChild;(!a||a.nodeName==="BR")&&(_(n),n.firstChild&&e.selectNodeContents(n.firstChild)),e.collapse(!0);let o=e.startContainer,l=e.startOffset,d=new O(n,5),c=o,h=l;(!(c instanceof Text)||h===c.data.length)&&(c=Ue(d,"nextNode",c),h=0);let u=o,f=l-1;(!(u instanceof Text)||f===-1)&&(u=Ue(d,"previousPONode",c||(o instanceof Text?o:o.childNodes[l]||o)),u instanceof Text&&(f=u.data.length));let m=null,C=0;return c instanceof Text&&c.data.charAt(h)===" "&&ee(e,n)?(m=c,C=h):u instanceof Text&&u.data.charAt(f)===" "&&(c instanceof Text&&c.data.charAt(h)===" "||oe(e,n))&&(m=u,C=f),m&&m.replaceData(C,1,"\xA0"),e.setStart(o,l),e.collapse(!0),s},At=(e,n,t)=>{let i=n.firstChild&&g(n.firstChild),r;for(D(n,t),r=n;r=H(r,t);)_(r);e.collapsed||G(e,t),b(e),e.collapse(!1);let s=v(e.endContainer,t,"BLOCKQUOTE")||t,a=B(e,t),o=null,l=H(n,n),d=!i&&!!a&&Ce(a);if(a&&l&&!d&&!v(l,n,"PRE")&&!v(l,n,"TABLE")){V(e,a,a,t),e.collapse(!0);let c=e.endContainer,h=e.endOffset;if(re(a,t,!1),g(c)){let u=y(c,h,$(c,t)||t,t);c=u.parentNode,h=Array.from(c.childNodes).indexOf(u)}if(h!==w(c))for(o=document.createDocumentFragment();r=c.childNodes[h];)o.appendChild(r);X(c,l,e,t),h=Array.from(c.parentNode.childNodes).indexOf(c)+1,c=c.parentNode,e.setEnd(c,h)}if(w(n)){d&&a&&(e.setEndBefore(a),e.collapse(!1),T(a)),V(e,s,s,t);let c=y(e.endContainer,e.endOffset,s,t),h=c?c.previousSibling:s.lastChild;s.insertBefore(n,c),c?e.setEndBefore(c):e.setEnd(s,w(s)),a=K(e,t),b(e);let u=e.endContainer,f=e.endOffset;c&&j(c)&&I(c,t),c=h&&h.nextSibling,c&&j(c)&&I(c,t),e.setEnd(u,f)}if(o&&a){let c=e.cloneRange();X(a,o,c,t),e.setEnd(c.endContainer,c.endOffset)}b(e)},ue=Array.prototype.indexOf,kt=(e,n,t,i,r,s)=>{let a=e.clipboardData,o=document.body,l=p("DIV"),d,c;n.childNodes.length===1&&n.childNodes[0]instanceof Text?(c=n.childNodes[0].data.replace(/ /g," "),s=!0):(l.appendChild(n),d=l.innerHTML,i&&(d=i(d))),c!==void 0||(r&&d!==void 0?c=r(d):(re(l,t,!0),l.setAttribute("style","position:fixed;overflow:hidden;bottom:100%;right:100%;"),o.appendChild(l),c=l.innerText||l.textContent,c=c.replace(/ /g," "),o.removeChild(l))),Fe&&(c=c.replace(/\r?\n/g,`\r
`)),!s&&d&&c!==d&&a.setData("text/html",d),a.setData("text/plain",c),e.preventDefault()},Ze=(e,n,t,i,r,s,a)=>{if(!ie&&e.clipboardData){let o=B(n,t),l=K(n,t),d=t;o===l&&o?.contains(n.commonAncestorContainer)&&(d=o);let c;i?c=G(n,t):(n=n.cloneRange(),b(n),V(n,d,d,t),c=n.cloneContents());let h=n.commonAncestorContainer;for(h instanceof Text&&(h=h.parentNode);h&&h!==d;){let u=h.cloneNode(!1);u.appendChild(c),c=u,h=h.parentNode}return kt(e,c,t,r,s,a),!0}return!1},Ot=function(e){let n=this.getSelection(),t=this._root;if(n.collapsed){e.preventDefault();return}this.saveUndoState(n),Ze(e,n,t,!0,this._config.willCutCopy,null,!1)||setTimeout(()=>{try{this._ensureBottomLine()}catch(i){this._config.didError(i)}},0),this.setSelection(n)},yt=function(e){Ze(e,this.getSelection(),this._root,!1,this._config.willCutCopy,null,!1)},Ie=function(e){this._isShiftDown=e.shiftKey},wt=function(e){let n=e.clipboardData,t=n?.items,i=this._isShiftDown,r=!1,s=!1,a=null,o=null;if(t){let x=t.length;for(;x--;){let k=t[x],E=k.type;E==="text/html"?o=k:E==="text/plain"||E==="text/uri-list"?a=k:E==="text/rtf"?r=!0:/^image\/.*/.test(E)&&(s=!0)}if(s&&!(r&&o)){e.preventDefault(),this.fireEvent("pasteImage",{clipboardData:n});return}if(!ie){e.preventDefault(),o&&(!i||!a)?o.getAsString(k=>{this.insertHTML(k,!0)}):a&&a.getAsString(k=>{let E=!1,Oe=this.getSelection();if(!Oe.collapsed&&U.test(Oe.toString())){let ye=this.linkRegExp.exec(k);E=!!ye&&ye[0].length===k.length}E?this.makeLink(k):this.insertPlainText(k,!0)});return}}let l=n?.types;if(!ie&&l&&(ue.call(l,"text/html")>-1||!ct&&ue.call(l,"text/plain")>-1&&ue.call(l,"text/rtf")<0)){e.preventDefault();let x;!i&&(x=n.getData("text/html"))?this.insertHTML(x,!0):((x=n.getData("text/plain"))||(x=n.getData("text/uri-list")))&&this.insertPlainText(x,!0);return}let d=document.body,c=this.getSelection(),h=c.startContainer,u=c.startOffset,f=c.endContainer,m=c.endOffset,C=p("DIV",{contenteditable:"true",style:"position:fixed; overflow:hidden; top:0; right:100%; width:1px; height:1px;"});d.appendChild(C),c.selectNodeContents(C),this.setSelection(c),setTimeout(()=>{try{let x="",k=C,E;for(;C=k;)k=C.nextSibling,T(C),E=C.firstChild,E&&E===C.lastChild&&E instanceof HTMLDivElement&&(C=E),x+=C.innerHTML;this.setSelection(W(h,u,f,m)),x&&this.insertHTML(x,!0)}catch(x){this._config.didError(x)}},0)},Bt=function(e){if(!e.dataTransfer)return;let n=e.dataTransfer.types,t=n.length,i=!1,r=!1;for(;t--;)switch(n[t]){case"text/plain":i=!0;break;case"text/html":r=!0;break;default:return}(r||i&&this.saveUndoState)&&this.saveUndoState()},Me=(e,n,t)=>{n.preventDefault(),e.splitBlock(n.shiftKey,t)},Y=(e,n)=>{try{n||(n=e.getSelection());let t=n.startContainer;t instanceof Text&&(t=t.parentNode);let i=t;for(;g(i)&&(!i.textContent||i.textContent===Z);)t=i,i=t.parentNode;t!==i&&(n.setStart(i,Array.from(i.childNodes).indexOf(t)),n.collapse(!0),i.removeChild(t),F(i)||(i=$(i,e._root)||e._root),_(i),b(n)),t===e._root&&(t=t.firstChild)&&t.nodeName==="BR"&&T(t),e._ensureBottomLine(),e.setSelection(n),e._updatePath(n,!0)}catch(t){e._config.didError(t)}},je=(e,n)=>{let t;for(;(t=e.parentNode)&&!(t===n||t.isContentEditable);)e=t;T(e)},$e=(e,n,t)=>{if(v(n,e._root,"A"))return;let i=n.data||"",r=Math.max(i.lastIndexOf(" ",t-1),i.lastIndexOf("\xA0",t-1))+1,s=i.slice(r,t),a=e.linkRegExp.exec(s);if(a){let o=e.getSelection();e._docWasChanged(),e._recordUndoState(o),e._getRangeAndRemoveBookmark(o);let l=r+a.index,d=l+a[0].length,c=o.startContainer===n,h=o.startOffset-d;l&&(n=n.splitText(l));let u=e._config.tagAttributes.a,f=p("A",Object.assign({href:a[1]?/^(?:ht|f)tps?:/i.test(a[1])?a[1]:"http://"+a[1]:"mailto:"+a[0]},u));f.textContent=i.slice(l,d),n.parentNode.insertBefore(f,n),n.data=i.slice(d),c&&(o.setStart(n,h),o.setEnd(n,h)),e.setSelection(o)}},Dt=(e,n,t)=>{let i=e._root;if(e._removeZWS(),e.saveUndoState(t),!t.collapsed)n.preventDefault(),G(t,i),Y(e,t);else if(ee(t,i)){n.preventDefault();let r=B(t,i);if(!r)return;let s=r;D(s.parentNode,i);let a=$(s,i);if(a){if(!a.isContentEditable){je(a,i);return}for(X(a,s,t,i),s=a.parentNode;s!==i&&!s.nextSibling;)s=s.parentNode;s!==i&&(s=s.nextSibling)&&I(s,i),e.setSelection(t)}else if(s){if(v(s,i,"UL")||v(s,i,"OL")){e.decreaseListLevel(t);return}else if(v(s,i,"BLOCKQUOTE")){e.removeQuote(t);return}e.setSelection(t),e._updatePath(t,!0)}}else{b(t);let r=t.startContainer,s=t.startOffset,a=r.parentNode;r instanceof Text&&a instanceof HTMLAnchorElement&&s&&a.href.includes(r.data)?(r.deleteData(s-1,1),e.setSelection(t),e.removeLink(),n.preventDefault()):(e.setSelection(t),setTimeout(()=>{Y(e)},0))}},Rt=(e,n,t)=>{let i=e._root,r,s,a,o,l,d;if(e._removeZWS(),e.saveUndoState(t),!t.collapsed)n.preventDefault(),G(t,i),Y(e,t);else if(oe(t,i)){if(n.preventDefault(),r=B(t,i),!r)return;if(D(r.parentNode,i),s=H(r,i),s){if(!s.isContentEditable){je(s,i);return}for(X(r,s,t,i),s=r.parentNode;s!==i&&!s.nextSibling;)s=s.parentNode;s!==i&&(s=s.nextSibling)&&I(s,i),e.setSelection(t),e._updatePath(t,!0)}}else{if(a=t.cloneRange(),V(t,i,i,i),o=t.endContainer,l=t.endOffset,o instanceof Element&&(d=o.childNodes[l],d&&d.nodeName==="IMG")){n.preventDefault(),T(d),b(t),Y(e,t);return}e.setSelection(a),setTimeout(()=>{Y(e)},0)}},Pt=(e,n,t)=>{let i=e._root;if(e._removeZWS(),t.collapsed&&ee(t,i)){let r=B(t,i),s;for(;s=r.parentNode;){if(s.nodeName==="UL"||s.nodeName==="OL"){n.preventDefault(),e.increaseListLevel(t);break}r=s}}},Ut=(e,n,t)=>{let i=e._root;if(e._removeZWS(),t.collapsed&&ee(t,i)){let r=t.startContainer;(v(r,i,"UL")||v(r,i,"OL"))&&(n.preventDefault(),e.decreaseListLevel(t))}},It=(e,n,t)=>{let i,r=e._root;if(e._recordUndoState(t),e._getRangeAndRemoveBookmark(t),t.collapsed||(G(t,r),e._ensureBottomLine(),e.setSelection(t),e._updatePath(t,!0)),i=t.endContainer,t.endOffset===w(i))do if(i.nodeName==="A"){t.setStartAfter(i);break}while(!i.nextSibling&&(i=i.parentNode)&&i!==r);if(e._config.addLinks){let s=t.cloneRange();b(s);let a=s.startContainer,o=s.startOffset;setTimeout(()=>{$e(e,a,o)},0)}e.setSelection(t)},Mt={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",32:"Space",33:"PageUp",34:"PageDown",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",46:"Delete",191:"/",219:"[",220:"\\",221:"]"},Ft=function(e){let n=e.keyCode,t=Mt[n],i="",r=this.getSelection();e.defaultPrevented||(t||(t=String.fromCharCode(n).toLowerCase(),/^[A-Za-z0-9]$/.test(t)||(t="")),111<n&&n<124&&(t="F"+(n-111)),t!=="Backspace"&&t!=="Delete"&&(e.altKey&&(i+="Alt-"),e.ctrlKey&&(i+="Ctrl-"),e.metaKey&&(i+="Meta-"),e.shiftKey&&(i+="Shift-")),Fe&&e.shiftKey&&t==="Delete"&&(i+="Shift-"),t=i+t,this._keyHandlers[t]?this._keyHandlers[t](this,e,r):!r.collapsed&&!e.isComposing&&!e.ctrlKey&&!e.metaKey&&(e.key||t).length===1&&(this.saveUndoState(r),G(r,this._root),this._ensureBottomLine(),this.setSelection(r),this._updatePath(r,!0)))},N={Backspace:Dt,Delete:Rt,Tab:Pt,"Shift-Tab":Ut,Space:It,ArrowLeft(e){e._removeZWS()},ArrowRight(e,n,t){e._removeZWS();let i=e.getRoot();if(oe(t,i)){b(t);let r=t.endContainer;do if(r.nodeName==="CODE"){let s=r.nextSibling;if(!(s instanceof Text)){let a=document.createTextNode("\xA0");r.parentNode.insertBefore(a,s),s=a}t.setStart(s,1),e.setSelection(t),n.preventDefault();break}while(!r.nextSibling&&(r=r.parentNode)&&r!==i)}}};ft||(N.Enter=Me,N["Shift-Enter"]=Me);!Ne&&!He&&(N.PageUp=e=>{e.moveCursorToStart()},N.PageDown=e=>{e.moveCursorToEnd()});var J=(e,n)=>(n=n||null,(t,i)=>{i.preventDefault();let r=t.getSelection();t.hasFormat(e,null,r)?t.changeFormat(null,{tag:e},r):t.changeFormat({tag:e},n,r)});N[A+"b"]=J("B");N[A+"i"]=J("I");N[A+"u"]=J("U");N[A+"Shift-7"]=J("S");N[A+"Shift-5"]=J("SUB",{tag:"SUP"});N[A+"Shift-6"]=J("SUP",{tag:"SUB"});N[A+"Shift-8"]=(e,n)=>{n.preventDefault();let t=e.getPath();/(?:^|>)UL/.test(t)?e.removeList():e.makeUnorderedList()};N[A+"Shift-9"]=(e,n)=>{n.preventDefault();let t=e.getPath();/(?:^|>)OL/.test(t)?e.removeList():e.makeOrderedList()};N[A+"["]=(e,n)=>{n.preventDefault();let t=e.getPath();/(?:^|>)BLOCKQUOTE/.test(t)||!/(?:^|>)[OU]L/.test(t)?e.decreaseQuoteLevel():e.decreaseListLevel()};N[A+"]"]=(e,n)=>{n.preventDefault();let t=e.getPath();/(?:^|>)BLOCKQUOTE/.test(t)||!/(?:^|>)[OU]L/.test(t)?e.increaseQuoteLevel():e.increaseListLevel()};N[A+"d"]=(e,n)=>{n.preventDefault(),e.toggleCode()};N[A+"z"]=(e,n)=>{n.preventDefault(),e.undo()};N[A+"y"]=N[A+"Shift-z"]=(e,n)=>{n.preventDefault(),e.redo()};var Ht=class{_root;_config;_isFocused;_lastSelection;_willRestoreSelection;_mayHaveZWS;_lastAnchorNode;_lastFocusNode;_path;_events;_undoIndex;_undoStack;_undoStackLength;_isInUndoState;_ignoreChange;_ignoreAllChanges;_isShiftDown;_keyHandlers;_mutation;constructor(e,n){this._root=e,this._config=this._makeConfig(n),this._isFocused=!1,this._lastSelection=W(e,0),this._willRestoreSelection=!1,this._mayHaveZWS=!1,this._lastAnchorNode=null,this._lastFocusNode=null,this._path="",this._events=new Map,this._undoIndex=-1,this._undoStack=[],this._undoStackLength=0,this._isInUndoState=!1,this._ignoreChange=!1,this._ignoreAllChanges=!1,this.addEventListener("selectionchange",this._updatePathOnEvent),this.addEventListener("blur",this._enableRestoreSelection),this.addEventListener("mousedown",this._disableRestoreSelection),this.addEventListener("touchstart",this._disableRestoreSelection),this.addEventListener("focus",this._restoreSelection),this._isShiftDown=!1,this.addEventListener("cut",Ot),this.addEventListener("copy",yt),this.addEventListener("paste",wt),this.addEventListener("drop",Bt),this.addEventListener("keydown",Ie),this.addEventListener("keyup",Ie),this.addEventListener("keydown",Ft),this._keyHandlers=Object.create(N);let t=new MutationObserver(()=>this._docWasChanged());t.observe(e,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),this._mutation=t,e.setAttribute("contenteditable","true");try{document.execCommand("enableObjectResizing",!1,"false"),document.execCommand("enableInlineTableEditing",!1,"false")}catch{}this.addEventListener("beforeinput",this._beforeInput),this.setHTML("")}destroy(){this._events.forEach((e,n)=>{this.removeEventListener(n)}),this._mutation.disconnect(),this._undoIndex=-1,this._undoStack=[],this._undoStackLength=0}_makeConfig(e){let n={blockTag:"DIV",blockAttributes:null,tagAttributes:{},classNames:{color:"color",fontFamily:"font",fontSize:"size",highlight:"highlight"},undo:{documentSizeThreshold:-1,undoLimit:-1},addLinks:!0,willCutCopy:null,sanitizeToDOMFragment:t=>{let i=DOMPurify.sanitize(t,{ALLOW_UNKNOWN_PROTOCOLS:!0,WHOLE_DOCUMENT:!1,RETURN_DOM:!0,RETURN_DOM_FRAGMENT:!0,FORCE_BODY:!1});return i?document.importNode(i,!0):document.createDocumentFragment()},didError:t=>console.log(t)};return e&&(Object.assign(n,e),n.blockTag=n.blockTag.toUpperCase()),n}setKeyHandler(e,n){return this._keyHandlers[e]=n,this}_beforeInput(e){switch(e.inputType){case"insertText":dt&&e.data&&e.data.includes(`
`)&&e.preventDefault();break;case"insertLineBreak":e.preventDefault(),this.splitBlock(!0);break;case"insertParagraph":e.preventDefault(),this.splitBlock(!1);break;case"insertOrderedList":e.preventDefault(),this.makeOrderedList();break;case"insertUnoderedList":e.preventDefault(),this.makeUnorderedList();break;case"historyUndo":e.preventDefault(),this.undo();break;case"historyRedo":e.preventDefault(),this.redo();break;case"formatBold":e.preventDefault(),this.bold();break;case"formaItalic":e.preventDefault(),this.italic();break;case"formatUnderline":e.preventDefault(),this.underline();break;case"formatStrikeThrough":e.preventDefault(),this.strikethrough();break;case"formatSuperscript":e.preventDefault(),this.superscript();break;case"formatSubscript":e.preventDefault(),this.subscript();break;case"formatJustifyFull":case"formatJustifyCenter":case"formatJustifyRight":case"formatJustifyLeft":{e.preventDefault();let n=e.inputType.slice(13).toLowerCase();n==="full"&&(n="justify"),this.setTextAlignment(n);break}case"formatRemove":e.preventDefault(),this.removeAllFormatting();break;case"formatSetBlockTextDirection":{e.preventDefault();let n=e.data;n==="null"&&(n=null),this.setTextDirection(n);break}case"formatBackColor":e.preventDefault(),this.setHighlightColor(e.data);break;case"formatFontColor":e.preventDefault(),this.setTextColor(e.data);break;case"formatFontName":e.preventDefault(),this.setFontFace(e.data);break}}handleEvent(e){this.fireEvent(e.type,e)}fireEvent(e,n){let t=this._events.get(e);if(/^(?:focus|blur)/.test(e)){let i=this._root===document.activeElement;if(e==="focus"){if(!i||this._isFocused)return this;this._isFocused=!0}else{if(i||!this._isFocused)return this;this._isFocused=!1}}if(t){let i=n instanceof Event?n:new CustomEvent(e,{detail:n});t=t.slice();for(let r of t)try{"handleEvent"in r?r.handleEvent(i):r.call(this,i)}catch(s){this._config.didError(s)}}return this}customEvents=new Set(["pathChange","select","input","pasteImage","undoStateChange"]);addEventListener(e,n){let t=this._events.get(e),i=this._root;return t||(t=[],this._events.set(e,t),this.customEvents.has(e)||(e==="selectionchange"&&(i=document),i.addEventListener(e,this,!0))),t.push(n),this}removeEventListener(e,n){let t=this._events.get(e),i=this._root;if(t){if(n){let r=t.length;for(;r--;)t[r]===n&&t.splice(r,1)}else t.length=0;t.length||(this._events.delete(e),this.customEvents.has(e)||(e==="selectionchange"&&(i=document),i.removeEventListener(e,this,!0)))}return this}focus(){return this._root.focus({preventScroll:!0}),this}blur(){return this._root.blur(),this}_enableRestoreSelection(){this._willRestoreSelection=!0}_disableRestoreSelection(){this._willRestoreSelection=!1}_restoreSelection(){this._willRestoreSelection&&this.setSelection(this._lastSelection)}_removeZWS(){this._mayHaveZWS&&(fe(this._root),this._mayHaveZWS=!1)}startSelectionId="squire-selection-start";endSelectionId="squire-selection-end";_saveRangeToBookmark(e){let n=p("INPUT",{id:this.startSelectionId,type:"hidden"}),t=p("INPUT",{id:this.endSelectionId,type:"hidden"}),i;P(e,n),e.collapse(!1),P(e,t),n.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING&&(n.id=this.endSelectionId,t.id=this.startSelectionId,i=n,n=t,t=i),e.setStartAfter(n),e.setEndBefore(t)}_getRangeAndRemoveBookmark(e){let n=this._root,t=n.querySelector("#"+this.startSelectionId),i=n.querySelector("#"+this.endSelectionId);if(t&&i){let r=t.parentNode,s=i.parentNode,a=Array.from(r.childNodes).indexOf(t),o=Array.from(s.childNodes).indexOf(i);r===s&&(o-=1),t.remove(),i.remove(),e||(e=document.createRange()),e.setStart(r,a),e.setEnd(s,o),Q(r,e),r!==s&&Q(s,e),e.collapsed&&(r=e.startContainer,r instanceof Text&&(s=r.childNodes[e.startOffset],(!s||!(s instanceof Text))&&(s=r.childNodes[e.startOffset-1]),s&&s instanceof Text&&(e.setStart(s,0),e.collapse(!0))))}return e||null}getSelection(){let e=window.getSelection(),n=this._root,t=null;if(this._isFocused&&e&&e.rangeCount){t=e.getRangeAt(0).cloneRange();let i=t.startContainer,r=t.endContainer;i&&z(i)&&t.setStartBefore(i),r&&z(r)&&t.setEndBefore(r)}return t&&n.contains(t.commonAncestorContainer)?this._lastSelection=t:(t=this._lastSelection,document.contains(t.commonAncestorContainer)||(t=null)),t||(t=W(n.firstElementChild||n,0)),t}setSelection(e){if(this._lastSelection=e,!this._isFocused)this._enableRestoreSelection();else{let n=window.getSelection();n&&("setBaseAndExtent"in Selection.prototype?n.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset):(n.removeAllRanges(),n.addRange(e)))}return this}_moveCursorTo(e){let n=this._root,t=W(n,e?0:n.childNodes.length);return b(t),this.setSelection(t),this}moveCursorToStart(){return this._moveCursorTo(!0)}moveCursorToEnd(){return this._moveCursorTo(!1)}getCursorPosition(){let e=this.getSelection(),n=e.getBoundingClientRect();if(n&&!n.top){this._ignoreChange=!0;let t=p("SPAN");t.textContent=Z,P(e,t),n=t.getBoundingClientRect();let i=t.parentNode;i.removeChild(t),Q(i,e)}return n}getPath(){return this._path}_updatePathOnEvent(){this._isFocused&&this._updatePath(this.getSelection())}_updatePath(e,n){let t=e.startContainer,i=e.endContainer,r;(n||t!==this._lastAnchorNode||i!==this._lastFocusNode)&&(this._lastAnchorNode=t,this._lastFocusNode=i,r=t&&i?t===i?this._getPath(i):"(selection)":"",this._path!==r&&(this._path=r,this.fireEvent("pathChange",{path:r}))),this.fireEvent(e.collapsed?"cursor":"select",{range:e})}_getPath(e){let n=this._root,t=this._config,i="";if(e&&e!==n){let r=e.parentNode;if(i=r?this._getPath(r):"",e instanceof HTMLElement){let s=e.id,a=e.classList,o=Array.from(a).sort(),l=e.dir,d=t.classNames;i+=(i?">":"")+e.nodeName,s&&(i+="#"+s),o.length&&(i+=".",i+=o.join(".")),l&&(i+="[dir="+l+"]"),a.contains(d.highlight)&&(i+="[backgroundColor="+e.style.backgroundColor.replace(/ /g,"")+"]"),a.contains(d.color)&&(i+="[color="+e.style.color.replace(/ /g,"")+"]"),a.contains(d.fontFamily)&&(i+="[fontFamily="+e.style.fontFamily.replace(/ /g,"")+"]"),a.contains(d.fontSize)&&(i+="[fontSize="+e.style.fontSize+"]")}}return i}modifyDocument(e){let n=this._mutation;return n&&(n.takeRecords().length&&this._docWasChanged(),n.disconnect()),this._ignoreAllChanges=!0,e(),this._ignoreAllChanges=!1,n&&(n.observe(this._root,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),this._ignoreChange=!1),this}_docWasChanged(){if(gt(),this._mayHaveZWS=!0,!this._ignoreAllChanges){if(this._ignoreChange){this._ignoreChange=!1;return}this._isInUndoState&&(this._isInUndoState=!1,this.fireEvent("undoStateChange",{canUndo:!0,canRedo:!1})),this.fireEvent("input")}}_recordUndoState(e,n){if(!this._isInUndoState||n){let t=this._undoIndex,i=this._undoStack,r=this._config.undo,s=r.documentSizeThreshold,a=r.undoLimit;n||(t+=1),t<this._undoStackLength&&(i.length=this._undoStackLength=t),e&&this._saveRangeToBookmark(e);let o=this._getRawHTML();s>-1&&o.length*2>s&&a>-1&&t>a&&(i.splice(0,t-a),t=a,this._undoStackLength=a),i[t]=o,this._undoIndex=t,this._undoStackLength+=1,this._isInUndoState=!0}return this}saveUndoState(e){return e||(e=this.getSelection()),this._recordUndoState(e,this._isInUndoState),this._getRangeAndRemoveBookmark(e),this}undo(){if(this._undoIndex!==0||!this._isInUndoState){this._recordUndoState(this.getSelection(),!1),this._undoIndex-=1,this._setRawHTML(this._undoStack[this._undoIndex]);let e=this._getRangeAndRemoveBookmark();e&&this.setSelection(e),this._isInUndoState=!0,this.fireEvent("undoStateChange",{canUndo:this._undoIndex!==0,canRedo:!0}),this.fireEvent("input")}return this}redo(){let e=this._undoIndex,n=this._undoStackLength;if(e+1<n&&this._isInUndoState){this._undoIndex+=1,this._setRawHTML(this._undoStack[this._undoIndex]);let t=this._getRangeAndRemoveBookmark();t&&this.setSelection(t),this.fireEvent("undoStateChange",{canUndo:!0,canRedo:e+2<n}),this.fireEvent("input")}return this}getRoot(){return this._root}_getRawHTML(){return this._root.innerHTML}_setRawHTML(e){let n=this._root;n.innerHTML=e;let t=n,i=t.firstChild;if(!i||i.nodeName==="BR"){let r=this.createDefaultBlock();i?t.replaceChild(r,i):t.appendChild(r)}else for(;t=H(t,n);)_(t);return this._ignoreChange=!0,this}getHTML(e){let n;e&&(n=this.getSelection(),this._saveRangeToBookmark(n));let t=this._getRawHTML().replace(/\u200B/g,"");return e&&this._getRangeAndRemoveBookmark(n),t}setHTML(e){let n=this._config.sanitizeToDOMFragment(e,this),t=this._root;ve(n,this._config),re(n,t,!1),D(n,t);let i=n,r=i.firstChild;if(!r||r.nodeName==="BR"){let a=this.createDefaultBlock();r?i.replaceChild(a,r):i.appendChild(a)}else for(;i=H(i,t);)_(i);for(this._ignoreChange=!0;r=t.lastChild;)t.removeChild(r);t.appendChild(n),this._undoIndex=-1,this._undoStack.length=0,this._undoStackLength=0,this._isInUndoState=!1;let s=this._getRangeAndRemoveBookmark()||W(t.firstElementChild||t,0);return this.saveUndoState(s),this.setSelection(s),this._updatePath(s,!0),this}insertHTML(e,n){let t=this._config,i=t.sanitizeToDOMFragment(e,this),r=this.getSelection();this.saveUndoState(r);try{let s=this._root;t.addLinks&&this.addDetectedLinks(i,i),ve(i,this._config),re(i,s,!1),Se(i),i.normalize();let a=i;for(;a=H(a,i);)_(a);let o=!0;if(n){let l=new CustomEvent("willPaste",{detail:{fragment:i}});this.fireEvent("willPaste",l),i=l.detail.fragment,o=!l.defaultPrevented}o&&(At(r,i,s),r.collapse(!1),Be(r,"A",s),this._ensureBottomLine()),this.setSelection(r),this._updatePath(r,!0),n&&this.focus()}catch(s){this._config.didError(s)}return this}insertElement(e,n){if(n||(n=this.getSelection()),n.collapse(!0),g(e))P(n,e),n.setStartAfter(e);else{let t=this._root,i=B(n,t),r=i||t,s=null;for(;r!==t&&!r.nextSibling;)r=r.parentNode;if(r!==t){let o=r.parentNode;s=y(o,r.nextSibling,t,t)}i&&Ce(i)&&T(i),t.insertBefore(e,s);let a=this.createDefaultBlock();t.insertBefore(a,s),n.setStart(a,0),n.setEnd(a,0),b(n)}return this.focus(),this.setSelection(n),this._updatePath(n),this}insertImage(e,n){let t=p("IMG",Object.assign({src:e},n));return this.insertElement(t),t}insertPlainText(e,n){let t=this.getSelection();if(t.collapsed&&v(t.startContainer,this._root,"PRE")){let d=t.startContainer,c=t.startOffset,h;if(!d||!(d instanceof Text)){let f=document.createTextNode("");d.insertBefore(f,d.childNodes[c]),h=f,c=0}else h=d;let u=!0;if(n){let f=new CustomEvent("willPaste",{detail:{text:e}});this.fireEvent("willPaste",f),e=f.detail.text,u=!f.defaultPrevented}return u&&(h.insertData(c,e),t.setStart(h,c+e.length),t.collapse(!0)),this.setSelection(t),this}let i=e.split(`
`),r=this._config,s=r.blockTag,a=r.blockAttributes,o="</"+s+">",l="<"+s;for(let d in a)l+=" "+d+'="'+Re(a[d])+'"';l+=">";for(let d=0,c=i.length;d<c;d+=1){let h=i[d];h=Re(h).replace(/ (?=(?: |$))/g,"&nbsp;"),d&&(h=l+(h||"<BR>")+o),i[d]=h}return this.insertHTML(i.join(""),n)}getSelectedText(){let e=this.getSelection();if(e.collapsed)return"";let n=e.startContainer,t=e.endContainer,i=new O(e.commonAncestorContainer,5,l=>M(e,l,!0));i.currentNode=n;let r=n,s="",a=!1,o;for((!(r instanceof Element)&&!(r instanceof Text)||!i.filter(r))&&(r=i.nextNode());r;)r instanceof Text?(o=r.data,o&&/\S/.test(o)&&(r===t&&(o=o.slice(0,e.endOffset)),r===n&&(o=o.slice(e.startOffset)),s+=o,a=!0)):(r.nodeName==="BR"||a&&!g(r))&&(s+=`
`,a=!1),r=i.nextNode();return s}getFontInfo(e){let n={color:void 0,backgroundColor:void 0,fontFamily:void 0,fontSize:void 0};e||(e=this.getSelection());let t=0,i=e.commonAncestorContainer;if(e.collapsed||i instanceof Text)for(i instanceof Text&&(i=i.parentNode);t<4&&i;){let r=i.style;if(r){let s=r.color;!n.color&&s&&(n.color=s,t+=1);let a=r.backgroundColor;!n.backgroundColor&&a&&(n.backgroundColor=a,t+=1);let o=r.fontFamily;!n.fontFamily&&o&&(n.fontFamily=o,t+=1);let l=r.fontSize;!n.fontSize&&l&&(n.fontSize=l,t+=1)}i=i.parentNode}return n}hasFormat(e,n,t){e=e.toUpperCase(),n||(n={}),t||(t=this.getSelection()),!t.collapsed&&t.startContainer instanceof Text&&t.startOffset===t.startContainer.length&&t.startContainer.nextSibling&&t.setStartBefore(t.startContainer.nextSibling),!t.collapsed&&t.endContainer instanceof Text&&t.endOffset===0&&t.endContainer.previousSibling&&t.setEndAfter(t.endContainer.previousSibling);let i=this._root,r=t.commonAncestorContainer;if(v(r,i,e,n))return!0;if(r instanceof Text)return!1;let s=new O(r,4,l=>M(t,l,!0)),a=!1,o;for(;o=s.nextNode();){if(!v(o,i,e,n))return!1;a=!0}return a}changeFormat(e,n,t,i){return t||(t=this.getSelection()),this.saveUndoState(t),n&&(t=this._removeFormat(n.tag.toUpperCase(),n.attributes||{},t,i)),e&&(t=this._addFormat(e.tag.toUpperCase(),e.attributes||{},t)),this.setSelection(t),this._updatePath(t,!0),this.focus()}_addFormat(e,n,t){let i=this._root;if(t.collapsed){let r=_(p(e,n));P(t,r);let s=r.firstChild||r,a=s instanceof Text?s.length:0;t.setStart(s,a),t.collapse(!0);let o=r;for(;g(o);)o=o.parentNode;fe(o,r)}else{let r=new O(t.commonAncestorContainer,5,d=>(d instanceof Text||d.nodeName==="BR"||d.nodeName==="IMG")&&M(t,d,!0)),{startContainer:s,startOffset:a,endContainer:o,endOffset:l}=t;if(r.currentNode=s,!(s instanceof Element)&&!(s instanceof Text)||!r.filter(s)){let d=r.nextNode();if(!d)return t;s=d,a=0}do{let d=r.currentNode;if(!v(d,i,e,n)){d===o&&d.length>l&&d.splitText(l),d===s&&a&&(d=d.splitText(a),o===s?(o=d,l-=a):o===s.parentNode&&(l+=1),s=d,a=0);let c=p(e,n);L(d,c),c.appendChild(d)}}while(r.nextNode());t=W(s,a,o,l)}return t}_removeFormat(e,n,t,i){this._saveRangeToBookmark(t);let r;t.collapsed&&(pe?r=document.createTextNode(Z):r=document.createTextNode(""),P(t,r));let s=t.commonAncestorContainer;for(;g(s);)s=s.parentNode;let a=t.startContainer,o=t.startOffset,l=t.endContainer,d=t.endOffset,c=[],h=(f,m)=>{if(M(t,f,!1))return;let C,x;if(!M(t,f,!0)){!(f instanceof HTMLInputElement)&&(!(f instanceof Text)||f.data)&&c.push([m,f]);return}if(f instanceof Text)f===l&&d!==f.length&&c.push([m,f.splitText(d)]),f===a&&o&&(f.splitText(o),c.push([m,f]));else for(C=f.firstChild;C;C=x)x=C.nextSibling,h(C,m)},u=Array.from(s.getElementsByTagName(e)).filter(f=>M(t,f,!0)&&ge(f,e,n));return i||u.forEach(f=>{h(f,f)}),c.forEach(([f,m])=>{f=f.cloneNode(!1),L(m,f),f.appendChild(m)}),u.forEach(f=>{L(f,S(f))}),this._getRangeAndRemoveBookmark(t),r&&t.collapse(!1),Q(s,t),t}bold(){return this.changeFormat({tag:"B"})}removeBold(){return this.changeFormat(null,{tag:"B"})}italic(){return this.changeFormat({tag:"I"})}removeItalic(){return this.changeFormat(null,{tag:"I"})}underline(){return this.changeFormat({tag:"U"})}removeUnderline(){return this.changeFormat(null,{tag:"U"})}strikethrough(){return this.changeFormat({tag:"S"})}removeStrikethrough(){return this.changeFormat(null,{tag:"S"})}subscript(){return this.changeFormat({tag:"SUB"},{tag:"SUP"})}removeSubscript(){return this.changeFormat(null,{tag:"SUB"})}superscript(){return this.changeFormat({tag:"SUP"},{tag:"SUB"})}removeSuperscript(){return this.changeFormat(null,{tag:"SUP"})}makeLink(e,n){let t=this.getSelection();if(t.collapsed){let i=e.indexOf(":")+1;if(i)for(;e[i]==="/";)i+=1;P(t,document.createTextNode(e.slice(i)))}return n=Object.assign({href:e},this._config.tagAttributes.a,n),this.changeFormat({tag:"A",attributes:n},{tag:"A"},t)}removeLink(){return this.changeFormat(null,{tag:"A"},this.getSelection(),!0)}linkRegExp=/\b(?:((?:(?:ht|f)tps?:\/\/|www\d{0,3}[.]|[a-z0-9][a-z0-9.\-]*[.][a-z]{2,}\/)(?:[^\s()<>]+|\([^\s()<>]+\))+(?:[^\s?&`!()\[\]{};:'".,<>«»“”‘’]|\([^\s()<>]+\)))|([\w\-.%+]+@(?:[\w\-]+\.)+[a-z]{2,}\b(?:[?][^&?\s]+=[^\s?&`!()\[\]{};:'".,<>«»“”‘’]+(?:&[^&?\s]+=[^\s?&`!()\[\]{};:'".,<>«»“”‘’]+)*)?))/i;addDetectedLinks(e,n){let t=new O(e,4,a=>!v(a,n||this._root,"A")),i=this.linkRegExp,r=this._config.tagAttributes.a,s;for(;s=t.nextNode();){let a=s.parentNode,o=s.data,l;for(;l=i.exec(o);){let d=l.index,c=d+l[0].length;d&&a.insertBefore(document.createTextNode(o.slice(0,d)),s);let h=p("A",Object.assign({href:l[1]?/^(?:ht|f)tps?:/i.test(l[1])?l[1]:"http://"+l[1]:"mailto:"+l[0]},r));h.textContent=o.slice(d,c),a.insertBefore(h,s),s.data=o=o.slice(c)}}return this}setFontFace(e){let n=this._config.classNames.fontFamily;return this.changeFormat(e?{tag:"SPAN",attributes:{class:n,style:"font-family: "+e+", sans-serif;"}}:null,{tag:"SPAN",attributes:{class:n}})}setFontSize(e){let n=this._config.classNames.fontSize;return this.changeFormat(e?{tag:"SPAN",attributes:{class:n,style:"font-size: "+(typeof e=="number"?e+"px":e)}}:null,{tag:"SPAN",attributes:{class:n}})}setTextColor(e){let n=this._config.classNames.color;return this.changeFormat(e?{tag:"SPAN",attributes:{class:n,style:"color:"+e}}:null,{tag:"SPAN",attributes:{class:n}})}setHighlightColor(e){let n=this._config.classNames.highlight;return this.changeFormat(e?{tag:"SPAN",attributes:{class:n,style:"background-color:"+e}}:null,{tag:"SPAN",attributes:{class:n}})}_ensureBottomLine(){let e=this._root,n=e.lastElementChild;(!n||n.nodeName!==this._config.blockTag||!F(n))&&e.appendChild(this.createDefaultBlock())}createDefaultBlock(e){let n=this._config;return _(p(n.blockTag,n.blockAttributes,e))}tagAfterSplit={DT:"DD",DD:"DT",LI:"LI",PRE:"PRE"};splitBlock(e,n){n||(n=this.getSelection());let t=this._root,i,r,s,a;if(this._recordUndoState(n),this._removeZWS(),this._getRangeAndRemoveBookmark(n),n.collapsed||G(n,t),this._config.addLinks){b(n);let h=n.startContainer,u=n.startOffset;setTimeout(()=>{$e(this,h,u)},0)}if(i=B(n,t),i&&(r=v(i,t,"PRE"))){b(n),s=n.startContainer;let h=n.startOffset;return s instanceof Text||(s=document.createTextNode(""),r.insertBefore(s,r.firstChild)),!e&&s instanceof Text&&(s.data.charAt(h-1)===`
`||ee(n,t))&&(s.data.charAt(h)===`
`||oe(n,t))?(s.deleteData(h&&h-1,h?2:1),a=y(s,h&&h-1,t,t),s=a.previousSibling,s.textContent||T(s),s=this.createDefaultBlock(),a.parentNode.insertBefore(s,a),a.textContent||T(a),n.setStart(s,0)):(s.insertData(h,`
`),_(r),s.length===h+1?n.setStartAfter(s):n.setStart(s,h+1)),n.collapse(!0),this.setSelection(n),this._updatePath(n,!0),this._docWasChanged(),this}if(!i||e||/^T[HD]$/.test(i.nodeName))return Be(n,"A",t),P(n,p("BR")),n.collapse(!1),this.setSelection(n),this._updatePath(n,!0),this;if((r=v(i,t,"LI"))&&(i=r),Ce(i)){if(v(i,t,"UL")||v(i,t,"OL"))return this.decreaseListLevel(n),this;if(v(i,t,"BLOCKQUOTE"))return this.removeQuote(n),this}s=n.startContainer;let o=n.startOffset,l=this.tagAfterSplit[i.nodeName];a=y(s,o,i.parentNode,this._root);let d=this._config,c=null;for(l||(l=d.blockTag,c=d.blockAttributes),ge(a,l,c)||(i=p(l,c),a.dir&&(i.dir=a.dir),L(a,i),i.appendChild(S(a)),a=i),fe(i),Se(i),_(i);a instanceof Element;){let h=a.firstChild,u;if(a.nodeName==="A"&&(!a.textContent||a.textContent===Z)){h=document.createTextNode(""),L(a,h),a=h;break}for(;h&&h instanceof Text&&!h.data&&(u=h.nextSibling,!(!u||u.nodeName==="BR"));)T(h),h=u;if(!h||h.nodeName==="BR"||h instanceof Text)break;a=h}return n=W(a,0),this.setSelection(n),this._updatePath(n,!0),this}forEachBlock(e,n,t){t||(t=this.getSelection()),n&&this.saveUndoState(t);let i=this._root,r=B(t,i),s=K(t,i);if(r&&s)do if(e(r)||r===s)break;while(r=H(r,i));return n&&(this.setSelection(t),this._updatePath(t,!0)),this}modifyBlocks(e,n){n||(n=this.getSelection()),this._recordUndoState(n,this._isInUndoState);let t=this._root;Pe(n,t),V(n,t,t,t);let i=Qe(n,t,t);if(!n.collapsed){let r=n.endContainer;if(r===t)n.collapse(!1);else{for(;r.parentNode!==t;)r=r.parentNode;n.setStartBefore(r),n.collapse(!0)}}return P(n,e.call(this,i)),n.endOffset<n.endContainer.childNodes.length&&I(n.endContainer.childNodes[n.endOffset],t),I(n.startContainer.childNodes[n.startOffset],t),this._getRangeAndRemoveBookmark(n),this.setSelection(n),this._updatePath(n,!0),this}setTextAlignment(e){return this.forEachBlock(n=>{let t=n.className.split(/\s+/).filter(i=>!!i&&!/^align/.test(i)).join(" ");e?(n.className=t+" align-"+e,n.style.textAlign=e):(n.className=t,n.style.textAlign="")},!0),this.focus()}setTextDirection(e){return this.forEachBlock(n=>{e?n.dir=e:n.removeAttribute("dir")},!0),this.focus()}_getListSelection(e,n){let t=e.commonAncestorContainer,i=e.startContainer,r=e.endContainer;for(;t&&t!==n&&!/^[OU]L$/.test(t.nodeName);)t=t.parentNode;if(!t||t===n)return null;for(i===t&&(i=i.childNodes[e.startOffset]),r===t&&(r=r.childNodes[e.endOffset]);i&&i.parentNode!==t;)i=i.parentNode;for(;r&&r.parentNode!==t;)r=r.parentNode;return[t,i,r]}increaseListLevel(e){e||(e=this.getSelection());let n=this._root,t=this._getListSelection(e,n);if(!t)return this.focus();let[i,r,s]=t;if(!r||r===i.firstChild)return this.focus();this._recordUndoState(e,this._isInUndoState);let a=i.nodeName,o=r.previousSibling,l,d;o.nodeName!==a&&(l=this._config.tagAttributes[a.toLowerCase()],o=p(a,l),i.insertBefore(o,r));do d=r===s?null:r.nextSibling,o.appendChild(r);while(r=d);return d=o.nextSibling,d&&I(d,n),this._getRangeAndRemoveBookmark(e),this.setSelection(e),this._updatePath(e,!0),this.focus()}decreaseListLevel(e){e||(e=this.getSelection());let n=this._root,t=this._getListSelection(e,n);if(!t)return this.focus();let[i,r,s]=t;r||(r=i.firstChild),s||(s=i.lastChild),this._recordUndoState(e,this._isInUndoState);let a,o=null;if(r){let l=i.parentNode;if(o=s.nextSibling?y(i,s.nextSibling,l,n):i.nextSibling,l!==n&&l.nodeName==="LI"){for(l=l.parentNode;o;)a=o.nextSibling,s.appendChild(o),o=a;o=i.parentNode.nextSibling}let d=!/^[OU]L$/.test(l.nodeName);do a=r===s?null:r.nextSibling,i.removeChild(r),d&&r.nodeName==="LI"&&(r=this.createDefaultBlock([S(r)])),l.insertBefore(r,o);while(r=a)}return i.firstChild||T(i),o&&I(o,n),this._getRangeAndRemoveBookmark(e),this.setSelection(e),this._updatePath(e,!0),this.focus()}_makeList(e,n){let t=se(e,this._root),i=this._config.tagAttributes,r=i[n.toLowerCase()],s=i.li,a;for(;a=t.nextNode();)if(a.parentNode instanceof HTMLLIElement&&(a=a.parentNode,t.currentNode=a.lastChild),a instanceof HTMLLIElement){a=a.parentNode;let o=a.nodeName;o!==n&&/^[OU]L$/.test(o)&&L(a,p(n,r,[S(a)]))}else{let o=p("LI",s);a.dir&&(o.dir=a.dir);let l=a.previousSibling;l&&l.nodeName===n?(l.appendChild(o),T(a)):L(a,p(n,r,[o])),o.appendChild(S(a)),t.currentNode=o}return e}makeUnorderedList(){return this.modifyBlocks(e=>this._makeList(e,"UL")),this.focus()}makeOrderedList(){return this.modifyBlocks(e=>this._makeList(e,"OL")),this.focus()}removeList(){return this.modifyBlocks(e=>{let n=e.querySelectorAll("UL, OL"),t=e.querySelectorAll("LI"),i=this._root;for(let r=0,s=n.length;r<s;r+=1){let a=n[r],o=S(a);D(o,i),L(a,o)}for(let r=0,s=t.length;r<s;r+=1){let a=t[r];F(a)?L(a,this.createDefaultBlock([S(a)])):(D(a,i),L(a,S(a)))}return e}),this.focus()}increaseQuoteLevel(e){return this.modifyBlocks(n=>p("BLOCKQUOTE",this._config.tagAttributes.blockquote,[n]),e),this.focus()}decreaseQuoteLevel(e){return this.modifyBlocks(n=>(Array.from(n.querySelectorAll("blockquote")).filter(t=>!v(t.parentNode,n,"BLOCKQUOTE")).forEach(t=>{L(t,S(t))}),n),e),this.focus()}removeQuote(e){return this.modifyBlocks(()=>this.createDefaultBlock([p("INPUT",{id:this.startSelectionId,type:"hidden"}),p("INPUT",{id:this.endSelectionId,type:"hidden"})]),e),this.focus()}code(){let e=this.getSelection();return e.collapsed||j(e.commonAncestorContainer)?(this.modifyBlocks(n=>{let t=this._root,i=document.createDocumentFragment(),r=se(n,t),s;for(;s=r.nextNode();){let o=s.querySelectorAll("BR"),l=[],d=o.length;for(let c=0;c<d;c+=1)l[c]=ae(o[c],!1);for(;d--;){let c=o[d];l[d]?L(c,document.createTextNode(`
`)):T(c)}for(o=s.querySelectorAll("CODE"),d=o.length;d--;)L(o[d],S(o[d]));i.childNodes.length&&i.appendChild(document.createTextNode(`
`)),i.appendChild(S(s))}let a=new O(i,4);for(;s=a.nextNode();)s.data=s.data.replace(/ /g," ");return i.normalize(),_(p("PRE",this._config.tagAttributes.pre,[i]))},e),this.focus()):this.changeFormat({tag:"CODE",attributes:this._config.tagAttributes.code},null,e),this}removeCode(){let e=this.getSelection(),n=e.commonAncestorContainer;return v(n,this._root,"PRE")?(this.modifyBlocks(t=>{let i=this._root,r=t.querySelectorAll("PRE"),s=r.length;for(;s--;){let a=r[s],o=new O(a,4),l;for(;l=o.nextNode();){let d=l.data;d=d.replace(/ (?= )/g,"\xA0");let c=document.createDocumentFragment(),h;for(;(h=d.indexOf(`
`))>-1;)c.appendChild(document.createTextNode(d.slice(0,h))),c.appendChild(p("BR")),d=d.slice(h+1);l.parentNode.insertBefore(c,l),l.data=d}D(a,i),L(a,S(a))}return t},e),this.focus()):this.changeFormat(null,{tag:"CODE"},e),this}toggleCode(){return this.hasFormat("PRE")||this.hasFormat("CODE")?this.removeCode():this.code(),this}_removeFormatting(e,n){for(let t=e.firstChild,i;t;t=i){if(i=t.nextSibling,g(t)){if(t instanceof Text||t.nodeName==="BR"||t.nodeName==="IMG"){n.appendChild(t);continue}}else if(F(t)){n.appendChild(this.createDefaultBlock([this._removeFormatting(t,document.createDocumentFragment())]));continue}this._removeFormatting(t,n)}return n}removeAllFormatting(e){if(e||(e=this.getSelection()),e.collapsed)return this.focus();let n=this._root,t=e.commonAncestorContainer;for(;t&&!F(t);)t=t.parentNode;if(t||(Pe(e,n),t=n),t instanceof Text)return this.focus();this.saveUndoState(e),V(e,t,t,n);let i=e.startContainer,r=e.startOffset,s=e.endContainer,a=e.endOffset,o=document.createDocumentFragment(),l=document.createDocumentFragment(),d=y(s,a,t,n),c=y(i,r,t,n),h;for(;c!==d;)h=c.nextSibling,o.appendChild(c),c=h;if(this._removeFormatting(o,l),l.normalize(),c=l.firstChild,h=l.lastChild,c){t.insertBefore(l,d);let u=Array.from(t.childNodes);r=u.indexOf(c),a=h?u.indexOf(h)+1:0}else d&&(r=Array.from(t.childNodes).indexOf(d),a=r);return e.setStart(t,r),e.setEnd(t,a),Q(t,e),b(e),this.setSelection(e),this._updatePath(e,!0),this.focus()}},Je=Ht;function le(e){for(let[n,t]of Object.entries(e))if(t&&typeof t=="object"){let i=t.__fn;i?typeof i=="string"?e[n]=i.split(".").reduce((r,s)=>r[s],window):Array.isArray(i)&&(e[n]=new Function(i[0],i[1])):le(t)}return e}function de(e){let n=e;do{if(n.nextSibling){e.parsedCallback();return}n=n.parentNode}while(n);setTimeout(()=>{de(e)})}var Te,be=class extends HTMLElement{connectedCallback(){Te&&clearTimeout(Te),de(this)}disconnectedCallback(){this.disconnected(),Te=setTimeout(()=>{this.destroyed(),this.config=null},1e3)}parsedCallback(){this.config||(this.config=le(JSON.parse(this.dataset.config||"{}")),this.created()),this.connected()}created(){}destroyed(){}connected(){}disconnected(){}},Ye=be;function Le(e){return typeof e>"u"}function ce(e,n,t){return Le(t)?e.getAttribute(n):(e.setAttribute(n,""+t),t)}function R(e){return document.createElement(e)}function Ee(e){let n=R("template");return n.innerHTML=e,n.content}function Ae(e,n,t={}){window.Sanitizer?e.setHTML(n):window.DOMPurify?e.innerHTML=window.DOMPurify.sanitize(n):e.innerHTML=n}async function Xe(e=!1){(!window.Sanitizer||e)&&!window.DOMPurify&&(window.DOMPurify=(await import("https://cdn.jsdelivr.net/npm/dompurify@3/+esm")).default)}function ke(){return window.bootstrap}var zt="squire-editor",he=class extends Ye{get el(){return this.querySelector("textarea")}created(){if(!this.el){let n=R("textarea");n.name=ce(this,"name"),n.value=ce(this,"value"),this.appendChild(n)}this.el.style.display="none",this.init()}async init(){await Xe(!0);let n=R("div");n.classList.add("mb-2"),this.appendChild(n);let t=[[{action:"bold",format:"b",removeAction:"removeBold",icon:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
        <path d="M8.21 13c2.106 0 3.412-1.087 3.412-2.823 0-1.306-.984-2.283-2.324-2.386v-.055a2.176 2.176 0 0 0 1.852-2.14c0-1.51-1.162-2.46-3.014-2.46H3.843V13H8.21zM5.908 4.674h1.696c.963 0 1.517.451 1.517 1.244 0 .834-.629 1.32-1.73 1.32H5.908V4.673zm0 6.788V8.598h1.73c1.217 0 1.88.492 1.88 1.415 0 .943-.643 1.449-1.832 1.449H5.907z"/>
      </svg>`},{action:"italic",format:"i",removeAction:"removeItalic",icon:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
        <path d="M7.991 11.674 9.53 4.455c.123-.595.246-.71 1.347-.807l.11-.52H7.211l-.11.52c1.06.096 1.128.212 1.005.807L6.57 11.674c-.123.595-.246.71-1.346.806l-.11.52h3.774l.11-.52c-1.06-.095-1.129-.211-1.006-.806z"/>
      </svg>`},{action:"underline",format:"u",removeAction:"removeUnderline",icon:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
        <path d="M5.313 3.136h-1.23V9.54c0 2.105 1.47 3.623 3.917 3.623s3.917-1.518 3.917-3.623V3.136h-1.23v6.323c0 1.49-.978 2.57-2.687 2.57-1.709 0-2.687-1.08-2.687-2.57V3.136zM12.5 15h-9v-1h9v1z"/>
      </svg>`},{action:"code",format:"code",removeAction:"removeCode",icon:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code" viewBox="0 0 16 16">
        <path d="M5.854 4.854a.5.5 0 1 0-.708-.708l-3.5 3.5a.5.5 0 0 0 0 .708l3.5 3.5a.5.5 0 0 0 .708-.708L2.707 8l3.147-3.146zm4.292 0a.5.5 0 0 1 .708-.708l3.5 3.5a.5.5 0 0 1 0 .708l-3.5 3.5a.5.5 0 0 1-.708-.708L13.293 8l-3.147-3.146z"/>
      </svg>`},{action:"removeAllFormatting",icon:`<svg width="16" height="16" viewBox="0 0 24 24" focusable="false">
        <path d="M13.2 6a1 1 0 0 1 0 .2l-2.6 10a1 1 0 0 1-1 .8h-.2a.8.8 0 0 1-.8-1l2.6-10H8a1 1 0 1 1 0-2h9a1 1 0 0 1 0 2h-3.8ZM5 18h7a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Zm13 1.5L16.5 18 15 19.5a.7.7 0 0 1-1-1l1.5-1.5-1.5-1.5a.7.7 0 0 1 1-1l1.5 1.5 1.5-1.5a.7.7 0 0 1 1 1L17.5 17l1.5 1.5a.7.7 0 0 1-1 1Z" fill-rule="evenodd"></path>
      </svg>`}],[{action:"makeLink",prompt:!0,format:"a",removeAction:"removeLink",icon:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link-45deg" viewBox="0 0 16 16">
          <path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"/>
          <path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"/>
        </svg>`},{action:"makeUnorderedList",format:"ul",removeAction:"removeList",icon:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
        </svg>`},{action:"makeOrderedList",format:"ul",removeAction:"removeList",icon:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5z"/>
          <path d="M1.713 11.865v-.474H2c.217 0 .363-.137.363-.317 0-.185-.158-.31-.361-.31-.223 0-.367.152-.373.31h-.59c.016-.467.373-.787.986-.787.588-.002.954.291.957.703a.595.595 0 0 1-.492.594v.033a.615.615 0 0 1 .569.631c.003.533-.502.8-1.051.8-.656 0-1-.37-1.008-.794h.582c.008.178.186.306.422.309.254 0 .424-.145.422-.35-.002-.195-.155-.348-.414-.348h-.3zm-.004-4.699h-.604v-.035c0-.408.295-.844.958-.844.583 0 .96.326.96.756 0 .389-.257.617-.476.848l-.537.572v.03h1.054V9H1.143v-.395l.957-.99c.138-.142.293-.304.293-.508 0-.18-.147-.32-.342-.32a.33.33 0 0 0-.342.338v.041zM2.564 5h-.635V2.924h-.031l-.598.42v-.567l.629-.443h.635V5z"/>
        </svg>`},{action:"increaseQuoteLevel",format:"blockquote",removeAction:"removeQuote",icon:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
          <path d="M12 12a1 1 0 0 0 1-1V8.558a1 1 0 0 0-1-1h-1.388c0-.351.021-.703.062-1.054.062-.372.166-.703.31-.992.145-.29.331-.517.559-.683.227-.186.516-.279.868-.279V3c-.579 0-1.085.124-1.52.372a3.322 3.322 0 0 0-1.085.992 4.92 4.92 0 0 0-.62 1.458A7.712 7.712 0 0 0 9 7.558V11a1 1 0 0 0 1 1h2Zm-6 0a1 1 0 0 0 1-1V8.558a1 1 0 0 0-1-1H4.612c0-.351.021-.703.062-1.054.062-.372.166-.703.31-.992.145-.29.331-.517.559-.683.227-.186.516-.279.868-.279V3c-.579 0-1.085.124-1.52.372a3.322 3.322 0 0 0-1.085.992 4.92 4.92 0 0 0-.62 1.458A7.712 7.712 0 0 0 3 7.558V11a1 1 0 0 0 1 1h2Z"/>
        </svg>`}],[{action:"undo",icon:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2v1z"/>
          <path d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466z"/>
        </svg>`},{action:"redo",icon:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
          <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
        </svg>`}]],i=(s,a=n)=>{let o=R("button");o.type="button",o.classList.add("btn","btn-light"),o.innerHTML=s.icon,o.dataset.action=s.action,o.dataset.removeAction=s.removeAction,o.dataset.format=s.format,o.dataset.prompt=s.prompt||"",a.appendChild(o)};t.forEach(s=>{if(Array.isArray(s)){let a=R("div");a.classList.add("btn-group","me-2"),n.appendChild(a),s.forEach(o=>i(o,a))}else i(s)});let r=R("div");ke()&&r.classList.add("form-control"),this.appendChild(r),this.config=Object.assign({blockTag:"p",tagAttributes:{blockquote:{class:"blockquote"}},sanitizeToDOMFragment:(s,a)=>{let o=R("div");Ae(o,s);let l=Ee(o.innerHTML);return l?document.importNode(l,!0):document.createDocumentFragment()}},this.config),this.editor=new Je(r,this.config),this.editor.setHTML(this.el.value)}connected(){this.addEventListener("click",this),this.addEventListener("input",this)}disconnected(){this.removeEventListener("click",this),this.removeEventListener("input",this)}handleEvent(n){this[`_${n.type}`](n)}_input(n){this.el.value=this.editor.getHTML()}_click(n){let t=n.target.closest("button");if(!t)return;let i=this.editor,r=t.dataset.action,s=t.dataset.removeAction,a=t.dataset.format,o=t.dataset.prompt,l=i.getSelection(),d;if(r&&i&&i[r])if(a&&s&&i.hasFormat(a))i[s]();else{if(o){if(l.collapsed)return;d=window.prompt()}i[r](d)}}destroyed(){this.editor.destroy(),this.editor=null}};customElements.define(zt,he);var un=he;})();
